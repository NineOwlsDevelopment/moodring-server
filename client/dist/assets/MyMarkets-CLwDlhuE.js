import{d as M,a0 as L,r as n,as as S,j as e,L as h,i as b,k as o,at as $,t as v}from"./index-ro5SsOap.js";const g={all:{label:"All",color:"text-gray-300",bgColor:"bg-dark-700"},pending:{label:"Pending Setup",color:"text-warning-400",bgColor:"bg-warning-500/20"},active:{label:"Active",color:"text-success-400",bgColor:"bg-success-500/20"},resolved:{label:"Resolved",color:"text-primary-400",bgColor:"bg-primary-500/20"},expired:{label:"Expired",color:"text-danger-400",bgColor:"bg-danger-500/20"}},W=()=>{const{user:x}=M(),p=L(),[l,w]=n.useState("all"),[r,N]=n.useState(null),[y,u]=n.useState(!0),[m,f]=n.useState(null);n.useEffect(()=>{x&&j()},[x,l]);const j=async()=>{u(!0);try{const t=await S({status:l});N(t)}catch(t){console.error("Failed to load markets:",t)}finally{u(!1)}},_=t=>t.is_initialized?t.is_resolved?"resolved":t.expiration_timestamp<=Math.floor(Date.now()/1e3)?"expired":"active":"pending",k=t=>{const s=new Date(t*1e3),a=new Date,i=s.getTime()-a.getTime();return i<0?`Expired ${Math.abs(Math.floor(i/(1e3*60*60*24)))}d ago`:i<1e3*60*60*24?`${Math.floor(i/(1e3*60*60))}h remaining`:`${Math.floor(i/(1e3*60*60*24))}d remaining`},C=async t=>{var s,a;if(m!==t){f(t);try{const c=(await $(t)).amount;v.success(`Successfully withdrew ${o(c)} in creator fees!`),await j()}catch(i){v.error(((a=(s=i.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to withdraw fees. Please try again.")}finally{f(null)}}};return x?e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-white",children:"My Markets"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage and monitor the markets you've created"})]}),e.jsxs(h,{to:"/create",className:"btn btn-primary",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Market"]})]}),(r==null?void 0:r.statusCounts)&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:["all","pending","active","resolved","expired"].map(t=>{const s=g[t],a=t==="all"?r.statusCounts.total:r.statusCounts[t];return e.jsxs("button",{onClick:()=>w(t),className:`card transition-all ${l===t?"ring-2 ring-primary-500 bg-primary-500/10":"hover:bg-dark-800"}`,children:[e.jsx("div",{className:`text-sm ${s.color} font-medium mb-1`,children:s.label}),e.jsx("div",{className:"text-3xl font-bold text-white",children:a})]},t)})}),y?e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((t,s)=>e.jsx("div",{className:"card h-32 animate-pulse bg-dark-800"},s))}):!r||r.markets.length===0?e.jsxs("div",{className:"card text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“­"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:l==="all"?"No markets yet":`No ${g[l].label.toLowerCase()} markets`}),e.jsx("p",{className:"text-gray-400 mb-6",children:l==="all"?"Create your first prediction market to get started":"You don't have any markets with this status"}),l==="all"&&e.jsx(h,{to:"/create",className:"btn btn-primary",children:"Create Your First Market"})]}):e.jsx("div",{className:"space-y-4",children:r.markets.map(t=>{var c;const s=_(t),a=g[s],i=s==="pending";return e.jsx("div",{className:"card border border-dark-700 hover:border-dark-600 transition-all",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:t.image_url||"/placeholder-market.png",alt:b(t.question),width:128,height:128,loading:"lazy",className:"w-full lg:w-32 h-32 object-cover rounded-lg bg-dark-800 max-w-full max-h-full",onError:d=>{d.target.src="https://placehold.co/128x128/1a1a2e/6366f1?text=?"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-start gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.bgColor} ${a.color}`,children:a.label}),(c=t.categories)==null?void 0:c.map(d=>e.jsx("span",{className:"px-2 py-1 bg-dark-700 text-gray-400 rounded-full text-xs",children:d.name},d.id))]}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2 line-clamp-2",children:b(t.question)}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),k(t.expiration_timestamp)]}),e.jsxs("span",{children:[t.total_options," options"]}),t.is_initialized&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Volume: ",o(t.total_volume)]}),e.jsxs("span",{children:["Liquidity:"," ",o(t.shared_pool_liquidity)]}),t.creator_fees_collected>0&&e.jsxs("span",{className:"text-success-400",title:"Creator fees earned from trading activity (separate from liquidity pool)",children:["Creator Fees:"," ",o(t.creator_fees_collected),t.lifetime_creator_fees_generated&&t.lifetime_creator_fees_generated>t.creator_fees_collected&&e.jsxs("span",{className:"text-moon-grey-dark ml-1",children:["(Lifetime:"," ",o(t.lifetime_creator_fees_generated),")"]})]}),t.lifetime_creator_fees_generated&&t.lifetime_creator_fees_generated>0&&t.creator_fees_collected===0&&e.jsxs("span",{className:"text-moon-grey-dark",title:"Total creator fees generated over market lifetime (all fees have been withdrawn)",children:["Lifetime Creator Fees:"," ",o(t.lifetime_creator_fees_generated)]})]})]}),i&&e.jsx("div",{className:"mt-4 p-4 bg-warning-500/10 border border-warning-500/30 rounded-lg",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-warning-300 text-sm font-medium mb-1",children:"Setup Required"}),e.jsx("p",{className:"text-gray-400 text-sm",children:t.total_options===0?"Add options to your market, then add liquidity to start trading.":t.total_options<2?"Add at least 2 options, then add liquidity to start trading.":"Add initial liquidity to activate trading on this market."})]}),e.jsxs("button",{onClick:()=>p(`/create?market=${t.id}`),className:"btn btn-primary whitespace-nowrap",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Continue Setup"]})]})})]}),e.jsxs("div",{className:"flex lg:flex-col gap-2 flex-shrink-0",children:[e.jsxs(h,{to:`/market/${t.id}`,className:"btn btn-secondary flex-1 lg:flex-none",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]}),s==="expired"&&!t.is_resolved&&e.jsxs("button",{onClick:()=>p(`/market/${t.id}`),className:"btn bg-primary-600 hover:bg-primary-700 text-white flex-1 lg:flex-none",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Resolve"]}),t.creator_fees_collected>0&&e.jsxs("button",{onClick:()=>C(t.id),disabled:m===t.id,className:"btn bg-success-600 hover:bg-success-700 text-white flex-1 lg:flex-none disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),m===t.id?"Withdrawing...":"Withdraw Creator Fees"]})]})]})},t.id)})}),r&&r.pagination.totalPages>1&&e.jsx("div",{className:"flex justify-center gap-2 mt-8",children:Array.from({length:r.pagination.totalPages}).map((t,s)=>e.jsx("button",{onClick:()=>{},className:`w-10 h-10 rounded-lg font-medium ${r.pagination.page===s+1?"bg-primary-600 text-white":"bg-dark-800 text-gray-400 hover:text-white"}`,children:s+1},s))})]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“Š"}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"My Markets"}),e.jsx("p",{className:"text-gray-400",children:"Connect your wallet to view your created markets"})]})};export{W as MyMarkets};
