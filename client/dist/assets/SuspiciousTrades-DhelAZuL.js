import{r as l,bh as w,t as n,j as e,ba as p,bi as y}from"./index-BIbQ-P7n.js";const N=()=>{const[o,f]=l.useState([]),[d,x]=l.useState({total:0,limit:50,offset:0,has_more:!1}),[v,u]=l.useState(!0),[m,h]=l.useState(null),[t,i]=l.useState({tradeId:null,reviewStatus:"reviewed",reviewNotes:"",riskScore:"",manualActionRequired:!1});l.useEffect(()=>{c()},[]);const c=async()=>{var s,a;try{u(!0);const r=await w({limit:d.limit,page:Math.floor(d.offset/d.limit)+1});f(r.suspicious_trades),x(r.pagination)}catch(r){console.error("Failed to load suspicious trades:",r),n.error(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to load suspicious trades")}finally{u(!1)}},b=async()=>{var s,a;if(t.tradeId)try{h(t.tradeId),await y(t.tradeId,{review_status:t.reviewStatus,review_notes:t.reviewNotes||void 0,risk_score:t.riskScore?Number(t.riskScore):void 0,manual_action_required:t.manualActionRequired}),n.success("Trade reviewed successfully"),i({tradeId:null,reviewStatus:"reviewed",reviewNotes:"",riskScore:"",manualActionRequired:!1}),c()}catch(r){console.error("Failed to review trade:",r),n.error(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to review trade")}finally{h(null)}},j=s=>{switch(s){case"flagged":return"text-red-400 bg-red-500/20 border-red-500/30";case"cleared":return"text-aqua-pulse bg-aqua-pulse/20 border-aqua-pulse/30";case"reviewed":return"text-blue-400 bg-blue-500/20 border-blue-500/30";default:return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30"}};return e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Suspicious Trades"}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Total: ",d.total," suspicious trades"]})]}),v?e.jsx("div",{className:"card flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-500"})}):o.length===0?e.jsx("div",{className:"card text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"No suspicious trades found"})}):e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Trade ID"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"User ID"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Risk Score"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Flags"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Created"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:o.map(s=>e.jsxs("tr",{className:"border-b border-dark-700 hover:bg-dark-800 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-xs text-gray-400",children:p(s.trade_id,8)})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-xs text-gray-400",children:p(s.user_id,8)})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.risk_score>=8?"text-red-400 bg-red-500/20":s.risk_score>=5?"text-yellow-400 bg-yellow-500/20":"text-aqua-pulse bg-aqua-pulse/20"}`,children:s.risk_score.toFixed(1)})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.flags.map((a,r)=>e.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-700 text-gray-300",children:a},r))})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${j(s.review_status)}`,children:s.review_status})}),e.jsx("td",{className:"py-3 px-4 text-gray-400 text-sm",children:new Date(typeof s.created_at=="string"&&s.created_at.includes(" ")?s.created_at.replace(" ","T"):s.created_at).toLocaleString()}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("button",{onClick:()=>i({tradeId:s.id,reviewStatus:s.review_status,reviewNotes:s.review_notes||"",riskScore:s.risk_score.toString(),manualActionRequired:s.manual_action_required||!1}),className:"text-primary-400 hover:text-primary-300 text-sm font-medium",children:"Review"})})]},s.id))})]})}),d.has_more&&e.jsx("div",{className:"flex justify-center mt-6 pt-6 border-t border-dark-700",children:e.jsx("button",{onClick:()=>{x(s=>({...s,offset:s.offset+s.limit})),c()},className:"btn btn-secondary",children:"Load More"})})]}),t.tradeId&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"card max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Review Suspicious Trade"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Review Status"}),e.jsxs("select",{value:t.reviewStatus,onChange:s=>i(a=>({...a,reviewStatus:s.target.value})),className:"input w-full",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"reviewed",children:"Reviewed"}),e.jsx("option",{value:"cleared",children:"Cleared"}),e.jsx("option",{value:"flagged",children:"Flagged"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Risk Score"}),e.jsx("input",{type:"number",min:"0",max:"10",step:"0.1",value:t.riskScore,onChange:s=>i(a=>({...a,riskScore:s.target.value})),className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Review Notes"}),e.jsx("textarea",{value:t.reviewNotes,onChange:s=>i(a=>({...a,reviewNotes:s.target.value})),placeholder:"Add review notes...",className:"input w-full",rows:4})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"manualAction",checked:t.manualActionRequired,onChange:s=>i(a=>({...a,manualActionRequired:s.target.checked})),className:"mr-2"}),e.jsx("label",{htmlFor:"manualAction",className:"text-sm text-gray-300",children:"Manual action required"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>i({tradeId:null,reviewStatus:"reviewed",reviewNotes:"",riskScore:"",manualActionRequired:!1}),className:"btn btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{onClick:b,disabled:m===t.tradeId,className:"btn btn-primary flex-1",children:m===t.tradeId?"Reviewing...":"Submit Review"})]})]})})]})};export{N as AdminSuspiciousTrades};
