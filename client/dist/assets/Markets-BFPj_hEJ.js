import{r as a,aK as te,t as h,j as e,m as d,A as D,b as v,L as se,b6 as re,b7 as ie,Q as ae}from"./index-4FQH80kW.js";const oe=()=>{const[j,L]=a.useState([]),[c,C]=a.useState(!0),[o,p]=a.useState(1),[n,V]=a.useState(1),[I,T]=a.useState(0),[g,W]=a.useState("all"),[b,F]=a.useState(""),[R,Y]=a.useState(""),[N,q]=a.useState(null),[z,f]=a.useState(!1),[x,w]=a.useState(null),[m,_]=a.useState(null),[k,S]=a.useState(1),[M,y]=a.useState(""),[Q,U]=a.useState(null);a.useEffect(()=>{const t=setTimeout(()=>{Y(b),p(1)},300);return()=>clearTimeout(t)},[b]),a.useEffect(()=>{u()},[o,g,R]);const u=async()=>{var t,i;try{C(!0);const s=await te({page:o,limit:25,sort:"created_at",order:"desc",status:g==="all"?void 0:g,search:R||void 0});L(s.markets||[]),s.pagination&&(V(s.pagination.totalPages),T(s.pagination.total))}catch(s){console.error("Failed to load markets:",s),h.error(((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.error)||"Failed to load markets")}finally{C(!1)}},B=async()=>{var t,i;if(!(!x||!m))try{q(x.id),await ae({marketId:x.id,optionId:m.id,outcome:m.option_label,winningSide:k,evidence:M.trim()?{notes:M.trim()}:void 0}),h.success("Market option resolved successfully"),f(!1),y(""),w(null),_(null),u()}catch(s){console.error("Failed to resolve market:",s),h.error(((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.error)||"Failed to resolve market option")}finally{q(null)}},K=async t=>{var i,s;try{await re(t.id,{is_featured:!t.is_featured}),h.success(t.is_featured?"Market unfeatured":"Market featured successfully"),u()}catch(l){console.error("Failed to toggle featured:",l),h.error(((s=(i=l.response)==null?void 0:i.data)==null?void 0:s.error)||"Failed to update market")}},G=async t=>{var i,s;try{await ie(t.id,{is_verified:!t.is_verified}),h.success(t.is_verified?"Market unverified":"Market verified successfully"),u()}catch(l){console.error("Failed to toggle verified:",l),h.error(((s=(i=l.response)==null?void 0:i.data)==null?void 0:s.error)||"Failed to update market")}},H=(t,i)=>{w(t),_(i),S(1),y(""),f(!0)},P=t=>new Date(t*1e3).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),J=t=>t.is_resolved?"resolved":t.is_initialized?t.expiration_timestamp<=Date.now()/1e3?"expired":"active":"pending",X=t=>{switch(t){case"active":return"text-emerald-400 border-emerald-400/30 bg-emerald-400/10";case"resolved":return"text-aqua-pulse border-aqua-pulse/30 bg-aqua-pulse/10";case"expired":return"text-amber-400 border-amber-400/30 bg-amber-400/10";case"pending":return"text-moon-grey border-moon-grey/30 bg-moon-grey/10";default:return"text-moon-grey/60 border-white/10"}},Z=[{key:"all",label:"All Markets"},{key:"active",label:"Active"},{key:"resolved",label:"Resolved"},{key:"expired",label:"Expired"}];return c&&j.length===0?e.jsx("div",{className:"min-h-screen bg-ink-black flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-neon-iris rounded-full animate-spin"})}):e.jsxs("div",{className:"min-h-screen bg-ink-black",children:[e.jsx("div",{className:"fixed inset-0 pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_80%_50%_at_50%_-20%,rgba(124,77,255,0.08),transparent_60%)]"})}),e.jsxs("div",{className:"relative p-6 lg:p-8",children:[e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] tracking-[0.3em] uppercase text-neon-iris/80 font-medium mb-3",children:"Administration"}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-extralight tracking-tight text-white",children:"Manage Markets"}),e.jsxs("p",{className:"text-sm text-moon-grey/50 mt-2",children:[I," total markets"]})]}),e.jsx("button",{onClick:u,disabled:c,className:"px-4 py-2.5 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300 disabled:opacity-50",children:c?"Loading...":"Refresh"})]}),e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:b,onChange:t=>F(t.target.value),placeholder:"Search markets by question or description...",className:"w-full bg-graphite-deep/50 border border-white/10 px-4 py-3 text-sm text-white placeholder-moon-grey/40 focus:outline-none focus:border-neon-iris/50 transition-colors"}),b&&e.jsx("button",{onClick:()=>F(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-moon-grey/40 hover:text-white transition-colors",children:"✕"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.map(t=>e.jsx("button",{onClick:()=>{W(t.key),p(1)},className:`px-4 py-2 text-xs tracking-wide uppercase font-medium border transition-all duration-300 ${g===t.key?"bg-gradient-to-r from-neon-iris to-aqua-pulse text-white border-transparent":"bg-white/5 text-moon-grey/70 border-white/10 hover:border-white/20 hover:text-white"}`,children:t.label},t.key))})]}),e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"space-y-3",children:e.jsx(D,{mode:"popLayout",children:j.length>0?j.map((t,i)=>{var O,E,A,$;const s=J(t),l=Q===t.id;return e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:i*.03},className:"bg-graphite-deep/30 border border-white/5 hover:border-white/10 transition-all duration-300",children:[e.jsx("div",{className:"p-5 cursor-pointer",onClick:()=>U(l?null:t.id),children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start gap-4",children:[e.jsxs("div",{className:"flex gap-4 flex-1 min-w-0",children:[t.image_url&&e.jsx("div",{className:"w-16 h-16 flex-shrink-0 rounded-lg overflow-hidden border border-white/10",children:e.jsx("img",{src:t.image_url,alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-light text-white text-sm leading-snug line-clamp-2",children:t.question}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2",children:[e.jsxs("span",{className:"text-[10px] text-moon-grey/40 font-mono",children:[t.id.slice(0,8),"..."]}),e.jsx("span",{className:`px-2 py-0.5 text-[10px] tracking-[0.1em] uppercase font-medium border ${X(s)}`,children:s}),t.is_featured&&e.jsx("span",{className:"px-2 py-0.5 text-[10px] tracking-[0.1em] uppercase font-medium text-amber-400 border border-amber-400/30 bg-amber-400/10",children:"Featured"}),t.is_verified&&e.jsx("span",{className:"px-2 py-0.5 text-[10px] tracking-[0.1em] uppercase font-medium text-neon-iris border border-neon-iris/30 bg-neon-iris/10",children:"Verified"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-6 lg:gap-8 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/40 mb-1",children:"Volume"}),e.jsx("div",{className:"text-white font-light tabular-nums",children:v(t.total_volume||0)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/40 mb-1",children:"Options"}),e.jsx("div",{className:"text-white font-light",children:((O=t.options)==null?void 0:O.length)||t.total_options||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/40 mb-1",children:"Created"}),e.jsx("div",{className:"text-white font-light",children:P(t.created_at)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/40 mb-1",children:"Expires"}),e.jsx("div",{className:"text-white font-light",children:P(t.expiration_timestamp)})]})]}),e.jsx("div",{className:"hidden lg:flex items-center",children:e.jsx("span",{className:`text-moon-grey/40 transition-transform duration-200 ${l?"rotate-180":""}`,children:"▼"})})]})}),e.jsx(D,{children:l&&e.jsx(d.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-5 pb-5 pt-0 border-t border-white/5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 py-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Creator"}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.creator_avatar_url?e.jsx("img",{src:t.creator_avatar_url,alt:"",className:"w-8 h-8 rounded-full border border-white/10"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-neon-iris/50 to-aqua-pulse/50 border border-white/10"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-white font-light",children:t.creator_display_name||t.creator_username||"Anonymous"}),t.creator_username&&e.jsxs("div",{className:"text-xs text-moon-grey/40",children:["@",t.creator_username]})]})]}),e.jsxs("div",{className:"text-[10px] text-moon-grey/40 font-mono",children:["ID: ",t.creator_id.slice(0,12),"..."]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Market Stats"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-moon-grey/60",children:"Liquidity"}),e.jsx("span",{className:"text-white font-light tabular-nums",children:((E=t.liquidity_parameter)==null?void 0:E.toLocaleString())||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-moon-grey/60",children:"Creator Fees"}),e.jsx("span",{className:"text-white font-light tabular-nums",children:v(t.creator_fees_collected||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-moon-grey/60",children:"Protocol Fees"}),e.jsx("span",{className:"text-white font-light tabular-nums",children:v(t.protocol_fees_collected||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-moon-grey/60",children:"Binary"}),e.jsx("span",{className:"text-white font-light",children:t.is_binary?"Yes":"No"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Categories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.categories&&t.categories.length>0?t.categories.map(r=>e.jsx("span",{className:"px-2.5 py-1 text-[10px] tracking-[0.1em] uppercase text-moon-grey/70 bg-white/5 border border-white/10",children:r.name},r.id)):t.category?e.jsx("span",{className:"px-2.5 py-1 text-[10px] tracking-[0.1em] uppercase text-moon-grey/70 bg-white/5 border border-white/10",children:t.category}):e.jsx("span",{className:"text-moon-grey/40 text-sm",children:"No categories"})})]})]}),t.market_description&&e.jsxs("div",{className:"py-4 border-t border-white/5",children:[e.jsx("h4",{className:"text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-moon-grey/70 leading-relaxed line-clamp-3",children:t.market_description})]}),e.jsxs("div",{className:"py-4 border-t border-white/5",children:[e.jsxs("h4",{className:"text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium mb-3",children:["Options (",((A=t.options)==null?void 0:A.length)||0,")"]}),e.jsx("div",{className:"space-y-2",children:($=t.options)==null?void 0:$.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-ink-black/50 border border-white/5 rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[r.option_image_url&&e.jsx("img",{src:r.option_image_url,alt:"",className:"w-8 h-8 rounded object-cover"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-white font-light",children:r.option_label||r.text||r.label||"Option"}),r.option_sub_label&&e.jsx("span",{className:"text-xs text-moon-grey/40 ml-2",children:r.option_sub_label})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[10px] text-moon-grey/40 uppercase",children:"Volume"}),e.jsx("div",{className:"text-xs text-white font-light tabular-nums",children:v(r.total_volume||0)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[10px] text-moon-grey/40 uppercase",children:"Yes/No"}),e.jsxs("div",{className:"text-xs text-white font-light tabular-nums",children:[((r.yes_price||.5)*100).toFixed(0),"% /"," ",((r.no_price||.5)*100).toFixed(0),"%"]})]}),r.is_resolved?e.jsx("span",{className:"px-2.5 py-1 text-[10px] tracking-[0.1em] uppercase text-aqua-pulse border border-aqua-pulse/30 bg-aqua-pulse/10",children:r.winning_side===1?"YES Won":r.winning_side===2?"NO Won":"Resolved"}):e.jsx("button",{onClick:ee=>{ee.stopPropagation(),H(t,r)},disabled:N===t.id,className:"px-3 py-1.5 text-[10px] tracking-[0.1em] uppercase font-medium text-neon-iris border border-neon-iris/30 hover:bg-neon-iris/10 disabled:opacity-50 transition-all",children:"Resolve"})]})]},r.id))})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-4 border-t border-white/5",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),K(t)},className:`px-4 py-2 text-xs tracking-wide uppercase font-medium border transition-all duration-300 ${t.is_featured?"text-amber-400 border-amber-400/30 bg-amber-400/10 hover:bg-amber-400/20":"text-moon-grey/60 border-white/10 hover:border-amber-400/30 hover:text-amber-400"}`,children:t.is_featured?"★ Featured":"☆ Feature"}),e.jsx("button",{onClick:r=>{r.stopPropagation(),G(t)},className:`px-4 py-2 text-xs tracking-wide uppercase font-medium border transition-all duration-300 ${t.is_verified?"text-neon-iris border-neon-iris/30 bg-neon-iris/10 hover:bg-neon-iris/20":"text-moon-grey/60 border-white/10 hover:border-neon-iris/30 hover:text-neon-iris"}`,children:t.is_verified?"✓ Verified":"○ Verify"}),e.jsx(se,{to:`/market/${t.id}`,onClick:r=>r.stopPropagation(),className:"px-4 py-2 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300",children:"View Market →"})]})]})})})]},t.id)}):e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-graphite-deep/30 border border-white/5 py-16 text-center",children:[e.jsx("div",{className:"text-moon-grey/40 text-sm mb-2",children:"No markets found"}),e.jsx("div",{className:"text-moon-grey/30 text-xs",children:"Try adjusting your filters or search query"})]})})}),n>1&&e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"flex justify-between items-center mt-6 p-4 bg-graphite-deep/20 border border-white/5",children:[e.jsx("button",{onClick:()=>p(t=>Math.max(1,t-1)),disabled:o===1||c,className:"px-4 py-2 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300 disabled:opacity-30",children:"← Previous"}),e.jsxs("div",{className:"flex items-center gap-2",children:[[...Array(Math.min(5,n))].map((t,i)=>{let s;return n<=5||o<=3?s=i+1:o>=n-2?s=n-4+i:s=o-2+i,e.jsx("button",{onClick:()=>p(s),disabled:c,className:`w-8 h-8 text-xs font-medium transition-all duration-300 ${o===s?"bg-gradient-to-r from-neon-iris to-aqua-pulse text-white":"text-moon-grey/50 hover:text-white hover:bg-white/5"}`,children:s},i)}),n>5&&o<n-2&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-moon-grey/30",children:"..."}),e.jsx("button",{onClick:()=>p(n),disabled:c,className:"w-8 h-8 text-xs font-medium text-moon-grey/50 hover:text-white hover:bg-white/5 transition-all duration-300",children:n})]})]}),e.jsx("button",{onClick:()=>p(t=>Math.min(n,t+1)),disabled:o===n||c,className:"px-4 py-2 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300 disabled:opacity-30",children:"Next →"})]}),z&&x&&m&&e.jsx("div",{className:"fixed inset-0 bg-ink-black/90 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>f(!1),children:e.jsxs(d.div,{initial:{opacity:0,y:20,scale:.98},animate:{opacity:1,y:0,scale:1},onClick:t=>t.stopPropagation(),className:"relative bg-graphite-deep border border-white/5 max-w-md w-full p-6",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-neon-iris/50 to-transparent"}),e.jsx("h2",{className:"text-xl font-light text-white mb-6",children:"Resolve Market Option"}),e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/40",children:"Market"}),e.jsx("p",{className:"text-sm text-white font-light mt-1 line-clamp-2",children:x.question})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/40",children:"Option"}),e.jsx("p",{className:"text-sm text-white font-light mt-1",children:m.option_label||m.text||m.label||"Option"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-3",children:"Winning Side"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>S(1),className:`flex-1 py-3 text-sm font-medium border transition-all duration-300 ${k===1?"bg-emerald-500/20 text-emerald-400 border-emerald-500/30":"bg-white/5 text-moon-grey/60 border-white/10 hover:border-white/20"}`,children:"YES"}),e.jsx("button",{onClick:()=>S(2),className:`flex-1 py-3 text-sm font-medium border transition-all duration-300 ${k===2?"bg-rose-500/20 text-rose-400 border-rose-500/30":"bg-white/5 text-moon-grey/60 border-white/10 hover:border-white/20"}`,children:"NO"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-3",children:"Reason (Optional)"}),e.jsx("textarea",{value:M,onChange:t=>y(t.target.value),className:"w-full bg-ink-black border border-white/10 px-4 py-3 text-sm text-white placeholder-moon-grey/40 focus:outline-none focus:border-neon-iris/50 transition-colors resize-none",rows:3,placeholder:"Reason for resolution..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{f(!1),w(null),_(null),y("")},className:"flex-1 py-3 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300",children:"Cancel"}),e.jsx("button",{onClick:B,disabled:N===x.id,className:"flex-1 py-3 text-xs tracking-wide uppercase font-medium bg-white text-ink-black hover:bg-moon-grey-light transition-all duration-300 disabled:opacity-50",children:N===x.id?"Resolving...":"Confirm Resolution"})]})]})})]})]})};export{oe as AdminMarkets};
