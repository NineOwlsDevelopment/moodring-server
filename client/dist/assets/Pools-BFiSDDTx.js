import{i as J,r,$ as he,j as e,b,h as P,aD as xe,t as B,aE as pe,a6 as be,aF as Z,ag as ge,m as N,L as ve,g as fe}from"./index-4FQH80kW.js";import{s as ye}from"./categorySort-BEAn0rC4.js";const we=({marketId:m,onAdded:M,compact:g=!1})=>{const{user:v}=J(),[p,h]=r.useState(!1),[o,c]=r.useState(""),[l,A]=r.useState(null),[k,F]=r.useState(!1),R=async()=>{if(v){F(!0);try{const n=(await P.get(`/market/${m}`)).data.market;A({shared_pool_liquidity:Number(n.shared_pool_liquidity||0),total_shared_lp_shares:Number(n.total_shared_lp_shares||0),accumulated_lp_fees:Number(n.accumulated_lp_fees||0),is_resolved:n.is_resolved||!1})}catch(i){console.error("Failed to load liquidity info:",i)}finally{F(!1)}}};r.useEffect(()=>{R()},[v,m]),he(m,{onMarket:i=>{i.event==="updated"&&i.data&&i.data.shared_pool_liquidity!==void 0&&A(n=>n&&{...n,shared_pool_liquidity:Number(i.data.shared_pool_liquidity),total_shared_lp_shares:Number(i.data.total_shared_lp_shares||n.total_shared_lp_shares),accumulated_lp_fees:Number(i.data.accumulated_lp_fees||n.accumulated_lp_fees)})}});const L=r.useMemo(()=>{if(!o||!l)return null;const i=parseFloat(o);if(isNaN(i)||i<=0)return null;const n=Math.floor(i*1e6),y=l.shared_pool_liquidity,x=l.total_shared_lp_shares;return x===0||y===0?(console.log("pool is empty, returning amountInMicroUSDC",n),n):Math.floor(n*x/y)},[o,l]),C=async()=>{var i,n;if(!(!v||!o||parseFloat(o)<=0)){h(!0);try{const y=await xe({market:m,amount:parseFloat(o)});B.success(`Successfully added ${b(y.amount_deposited)} liquidity! You received ${b(y.shares_minted)} LP shares.`),c(""),M&&M()}catch(y){B.error(((n=(i=y.response)==null?void 0:i.data)==null?void 0:n.error)||"Failed to add liquidity. Please try again.")}finally{h(!1)}}};return v?g?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-moon-grey-dark mb-1.5",children:"Amount (USDC)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",min:"0.01",value:o,onChange:i=>c(i.target.value),placeholder:"0.00",className:"w-full px-4 py-3 pr-16 bg-white/[0.03] border border-white/[0.08] rounded-xl text-white text-lg font-medium tabular-nums placeholder-moon-grey-dark focus:border-neon-iris/50 focus:ring-1 focus:ring-neon-iris/25 transition-all [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",disabled:p}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex flex-col border border-white/[0.08] rounded-md overflow-hidden bg-white/[0.03] backdrop-blur-sm",children:[e.jsx("button",{type:"button",onClick:()=>{const i=parseFloat(o)||0,n=Math.max(.01,i+1);c(String(n.toFixed(2)))},disabled:p,className:"w-7 h-6 flex items-center justify-center bg-white/[0.05] hover:bg-neon-iris/20 hover:border-neon-iris/50 text-moon-grey-dark hover:text-neon-iris-light active:bg-neon-iris/30 transition-all duration-200 border-b border-white/[0.08] disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white/[0.05] disabled:hover:text-moon-grey-dark group","aria-label":"Increment",children:e.jsx("svg",{className:"w-3.5 h-3.5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{type:"button",onClick:()=>{const i=parseFloat(o)||0,n=Math.max(.01,i-1);c(String(n.toFixed(2)))},disabled:p,className:"w-7 h-6 flex items-center justify-center bg-white/[0.05] hover:bg-neon-iris/20 hover:border-neon-iris/50 text-moon-grey-dark hover:text-neon-iris-light active:bg-neon-iris/30 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white/[0.05] disabled:hover:text-moon-grey-dark group","aria-label":"Decrement",children:e.jsx("svg",{className:"w-3.5 h-3.5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})})]})]})]}),l&&e.jsxs("div",{className:"text-[10px] text-moon-grey-dark space-y-0.5",children:[e.jsxs("div",{children:["Pool: ",b(l.shared_pool_liquidity)]}),L!==null&&o&&parseFloat(o)>0&&e.jsxs("div",{className:"text-aqua-pulse/80",children:["You will receive: ",b(L).replace("$","")," ","LP shares"]})]}),e.jsx("button",{onClick:C,disabled:p||!o||parseFloat(o)<=0,className:"w-full py-2.5 rounded-xl font-semibold text-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed bg-neon-iris hover:bg-neon-iris/90 text-white shadow-lg shadow-neon-iris/25",children:p?"Adding...":"Add Liquidity"}),!(l!=null&&l.is_resolved)&&e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-2.5",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("p",{className:"text-[10px] text-amber-400/90 leading-relaxed",children:[e.jsx("span",{className:"font-semibold",children:"Funds will be locked"})," ","until the market is resolved. You can only withdraw your proportional share of available liquidity after resolution."]})]})})]}):e.jsxs("div",{className:"px-4 py-3 bg-neon-iris/10 rounded-lg border border-neon-iris/20",children:[e.jsx("h4",{className:"text-sm font-medium text-white mb-3",children:"Add Liquidity"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-moon-grey-dark mb-1.5",children:"Amount (USDC)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",min:"0.01",value:o,onChange:i=>c(i.target.value),placeholder:"0.00",className:"w-full px-4 py-3 pr-16 bg-white/[0.03] border border-white/[0.08] rounded-xl text-white text-lg font-medium tabular-nums placeholder-moon-grey-dark focus:border-neon-iris/50 focus:ring-1 focus:ring-neon-iris/25 transition-all [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",disabled:p}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex flex-col border border-white/[0.08] rounded-md overflow-hidden bg-white/[0.03] backdrop-blur-sm",children:[e.jsx("button",{type:"button",onClick:()=>{const i=parseFloat(o)||0,n=Math.max(.01,i+1);c(String(n.toFixed(2)))},disabled:p,className:"w-7 h-6 flex items-center justify-center bg-white/[0.05] hover:bg-neon-iris/20 hover:border-neon-iris/50 text-moon-grey-dark hover:text-neon-iris-light active:bg-neon-iris/30 transition-all duration-200 border-b border-white/[0.08] disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white/[0.05] disabled:hover:text-moon-grey-dark group","aria-label":"Increment",children:e.jsx("svg",{className:"w-3.5 h-3.5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{type:"button",onClick:()=>{const i=parseFloat(o)||0,n=Math.max(.01,i-1);c(String(n.toFixed(2)))},disabled:p,className:"w-7 h-6 flex items-center justify-center bg-white/[0.05] hover:bg-neon-iris/20 hover:border-neon-iris/50 text-moon-grey-dark hover:text-neon-iris-light active:bg-neon-iris/30 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white/[0.05] disabled:hover:text-moon-grey-dark group","aria-label":"Decrement",children:e.jsx("svg",{className:"w-3.5 h-3.5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})})]})]})]}),l&&e.jsxs("div",{className:"text-xs text-moon-grey space-y-1",children:[e.jsxs("div",{children:["Current Pool: ",b(l.shared_pool_liquidity)]}),l.accumulated_lp_fees>0&&e.jsxs("div",{children:["Fees Earned: ",b(l.accumulated_lp_fees)]}),L!==null&&o&&parseFloat(o)>0&&e.jsxs("div",{className:"text-aqua-pulse/80 font-medium pt-1 border-t border-white/5",children:["You will receive: ",b(L).replace("$","")," ","LP shares"]})]}),e.jsx("button",{onClick:C,disabled:p||!o||parseFloat(o)<=0,className:"w-full py-2.5 rounded-xl font-semibold text-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed bg-neon-iris hover:bg-neon-iris/90 text-white shadow-lg shadow-neon-iris/25",children:p?"Adding...":"Add Liquidity"}),e.jsx("p",{className:"text-[10px] text-moon-grey-dark",children:"Earn fees from trading activity. LP shares represent your share of the liquidity pool."}),!(l!=null&&l.is_resolved)&&e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-amber-400/90 font-semibold mb-1",children:"Funds Will Be Locked"}),e.jsx("p",{className:"text-[10px] text-amber-400/80 leading-relaxed",children:"Your liquidity will be locked until the market is resolved. After resolution, you can withdraw your proportional share of available liquidity (total liquidity minus outstanding shares redeemable)."})]})]})})]})]}):null},je=({marketId:m,onRemoved:M})=>{const{user:g}=J(),[v,p]=r.useState(!1),[h,o]=r.useState(""),[c,l]=r.useState(null),[A,k]=r.useState(!1),[F,R]=r.useState(!1);r.useEffect(()=>{(async()=>{if(g){k(!0);try{const f=(await P.get(`/liquidity/position/${m}`)).data.position,$=(await P.get(`/market/${m}`)).data.market;R(($==null?void 0:$.is_resolved)||!1),f&&Number(f.shares)>0?l({shares:Number(f.shares),deposited_amount:Number(f.deposited_amount),current_value:Number(f.current_value),claimable_value:Number(f.claimable_value||0)}):l(null)}catch(u){console.error("Failed to load LP position:",u),l(null)}finally{k(!1)}}})()},[g,m]);const L=async()=>{var u,f;if(!g||!c||!h||parseFloat(h)<=0)return;const x=parseFloat(h)*1e6;if(x>c.shares){B.error("Cannot remove more shares than you have");return}p(!0);try{const w=await pe({market:m,shares:x});B.success(`Successfully removed liquidity! You received ${b(w.usdc_returned)} and ${b(w.fees_earned)} in fees.`),o(""),await C(),M&&M()}catch(w){B.error(((f=(u=w.response)==null?void 0:u.data)==null?void 0:f.error)||"Failed to remove liquidity. Please try again.")}finally{p(!1)}},C=async()=>{if(g)try{const u=(await P.get(`/liquidity/position/${m}`)).data.position,w=(await P.get(`/market/${m}`)).data.market;R((w==null?void 0:w.is_resolved)||!1),u&&Number(u.shares)>0?l({shares:Number(u.shares),deposited_amount:Number(u.deposited_amount),current_value:Number(u.current_value),claimable_value:Number(u.claimable_value||0)}):l(null)}catch(x){console.error("Failed to load LP position:",x),l(null)}};if(!g)return null;if(A)return e.jsx("div",{className:"py-2 text-sm text-gray-400",children:"Loading LP position..."});if(!c||c.shares<=0)return e.jsx("div",{className:"text-sm text-moon-grey-dark",children:"You don't have any liquidity in this pool"});const i=c.shares/1e6,n=c.claimable_value??c.current_value,y=h?parseFloat(h)/i*n:0;return F?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-moon-grey-dark mb-1.5",children:"LP Shares to Remove"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",min:"0.01",max:i,value:h,onChange:x=>o(x.target.value),placeholder:"0.00",className:"w-full px-4 py-3 pr-16 bg-white/[0.03] border border-white/[0.08] rounded-xl text-white text-lg font-medium tabular-nums placeholder-moon-grey-dark focus:border-neon-iris/50 focus:ring-1 focus:ring-neon-iris/25 transition-all [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",disabled:v}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex flex-col border border-white/[0.08] rounded-md overflow-hidden bg-white/[0.03] backdrop-blur-sm",children:[e.jsx("button",{type:"button",onClick:()=>{const x=parseFloat(h)||0,u=Math.min(i,Math.max(.01,x+1));o(String(u.toFixed(2)))},disabled:v,className:"w-7 h-6 flex items-center justify-center bg-white/[0.05] hover:bg-neon-iris/20 hover:border-neon-iris/50 text-moon-grey-dark hover:text-neon-iris-light active:bg-neon-iris/30 transition-all duration-200 border-b border-white/[0.08] disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white/[0.05] disabled:hover:text-moon-grey-dark group","aria-label":"Increment",children:e.jsx("svg",{className:"w-3.5 h-3.5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{type:"button",onClick:()=>{const x=parseFloat(h)||0,u=Math.max(.01,x-1);o(String(u.toFixed(2)))},disabled:v,className:"w-7 h-6 flex items-center justify-center bg-white/[0.05] hover:bg-neon-iris/20 hover:border-neon-iris/50 text-moon-grey-dark hover:text-neon-iris-light active:bg-neon-iris/30 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white/[0.05] disabled:hover:text-moon-grey-dark group","aria-label":"Decrement",children:e.jsx("svg",{className:"w-3.5 h-3.5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("span",{className:"text-xs text-moon-grey-dark",children:["Max: ",b(c.shares)," LP"]}),e.jsx("button",{onClick:()=>o(i.toString()),className:"text-xs text-neon-iris hover:text-neon-iris/80 transition-colors",children:"Max"})]})]}),h&&parseFloat(h)>0&&e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-moon-grey-dark",children:"You'll Receive"}),e.jsx("span",{className:"text-white font-semibold tabular-nums",children:b(y)})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-moon-grey-dark",children:[e.jsx("span",{children:"From Available Liquidity"}),e.jsxs("span",{className:"text-moon-grey",children:[b(n)," available"]})]})]}),e.jsxs("div",{className:"text-xs text-moon-grey-dark space-y-1",children:[e.jsxs("div",{children:["Your Position: ",b(c.current_value)," (",b(c.shares)," LP)"]}),c.claimable_value!==void 0&&c.claimable_value<c.current_value&&e.jsxs("div",{className:"text-amber-400",children:["Note: Only ",b(n)," is available for withdrawal. The remaining liquidity is reserved for outstanding shares redeemable."]})]}),e.jsx("button",{onClick:L,disabled:v||!h||parseFloat(h)<=0||parseFloat(h)>i,className:"w-full py-2.5 rounded-xl font-semibold text-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed bg-rose-500 hover:bg-rose-400 text-white shadow-lg shadow-rose-500/25",children:v?"Removing...":"Remove Liquidity"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("h3",{className:"text-sm font-semibold text-amber-400",children:"LP Shares Locked"})]}),e.jsx("p",{className:"text-xs text-amber-400/80",children:"Your LP shares are locked until the market is resolved. Once the market resolves, you can withdraw your proportional share of available liquidity (total liquidity minus outstanding shares redeemable)."})]}),e.jsx("div",{className:"text-xs text-moon-grey-dark space-y-1",children:e.jsxs("div",{children:["Your Position: ",b(c.current_value)," (",b(c.shares).replace("$","")," LP)"]})})]})},G=12,ee={animate:{transition:{staggerChildren:.05}}},te={initial:{opacity:0,y:15},animate:{opacity:1,y:0}},_e=()=>{const{user:m}=J(),M=be(),[g,v]=r.useState("all"),[p,h]=r.useState("admin"),[o,c]=r.useState("all"),[l,A]=r.useState("tvl"),[k,F]=r.useState([]),[R,L]=r.useState([]),[C,i]=r.useState([]),[n,y]=r.useState(!0),[x,u]=r.useState(!1),[f,w]=r.useState(!1),[$,O]=r.useState(1),[S,q]=r.useState(null),[se,D]=r.useState(!1),[ae,V]=r.useState(!1),[re,ie]=r.useState([{id:"all",label:"All Categories"}]),W=r.useRef(null),E=r.useCallback(t=>{const s=(Number(t.shared_pool_liquidity)||0)/1e6;if(!s||s===0)return 0;const a=(Number(t.accumulated_lp_fees)||0)/1e6,d=(Date.now()-Number(t.created_at)*1e3)/(1e3*60*60*24),_=Math.max(1,d);return a/s*365/_*100},[]),H=r.useCallback(t=>C.find(s=>s.market_id===t),[C]),z=r.useCallback(t=>{let s=[...t];return g==="my-pools"&&(s=s.filter(a=>H(a.id))),o!=="all"&&(s=s.filter(a=>{var d;return((d=a.categories)==null?void 0:d.some(_=>_.name.toLowerCase()===o))||!1})),s},[g,o,H]),Y=r.useCallback(t=>{const s=[...t];return s.sort((a,d)=>{switch(l){case"tvl":{const _=(Number(a.shared_pool_liquidity)||0)/1e6+(Number(a.accumulated_lp_fees)||0)/1e6;return(Number(d.shared_pool_liquidity)||0)/1e6+(Number(d.accumulated_lp_fees)||0)/1e6-_}case"apr":return E(d)-E(a);case"fees":{const _=(Number(a.accumulated_lp_fees)||0)/1e6;return(Number(d.accumulated_lp_fees)||0)/1e6-_}case"newest":return Number(d.created_at)-Number(a.created_at);case"oldest":return Number(a.created_at)-Number(d.created_at);case"volume":return Number(d.total_volume||0)-Number(a.total_volume||0);default:return 0}}),s},[l,E]),U=r.useCallback((t,s)=>{F(a=>a.map(d=>d.id===t?{...d,...s}:d))},[]);r.useEffect(()=>{(async()=>{try{const{categories:s}=await fe(),a=ye(s);ie([{id:"all",label:"All Categories"},...a.map(d=>({id:d.name.toLowerCase(),label:d.name}))])}catch(s){console.error("Failed to load categories:",s)}})()},[]),r.useEffect(()=>{Z.connect();const t=a=>{a.event==="updated"&&a.data&&W.current===a.market_id&&(U(a.market_id,{shared_pool_liquidity:Number(a.data.shared_pool_liquidity||0),total_shared_lp_shares:Number(a.data.total_shared_lp_shares||0),accumulated_lp_fees:Number(a.data.accumulated_lp_fees||0)}),m&&T(),W.current=null)},s=Z.onMarket(t);return()=>s()},[m,U]),r.useEffect(()=>{const t=z(k),s=Y(t);O(1),L(s.slice(0,G)),w(s.length>G)},[k,z,Y]);const oe=async(t=!0)=>{t?(y(!0),O(1)):u(!0);try{const d=((await P.get("/market",{params:{status:"active",limit:1e3,creator_type:p,category:o!=="all"?o:void 0}})).data.markets||[]).filter(j=>j.is_initialized&&Number(j.shared_pool_liquidity||0)>0&&!j.is_resolved),_=await Promise.all(d.map(async j=>{try{const X=await P.get(`/liquidity/share-value/${j.id}`);return{...j,lp_count:X.data.lp_count||0}}catch{return{...j,lp_count:0}}}));F(_)}catch(s){console.error("Failed to load pools:",s),B.error("Failed to load pools")}finally{y(!1),u(!1)}};r.useEffect(()=>{oe(),m?T():g==="my-pools"&&v("all")},[m,p,o,g]);const T=async()=>{try{const t=await ge();i(t.positions)}catch(t){console.error("Failed to load positions:",t)}},ne=r.useCallback(()=>{x||!f||(u(!0),setTimeout(()=>{const t=z(k),s=Y(t),a=$+1,d=s.slice(0,a*G);L(d),O(a),w(d.length<s.length),u(!1)},100))},[k,$,x,f,z,Y]),K=t=>{W.current=t,q(t),D(!0)},le=t=>{W.current=t,q(t),V(!0)},Q=r.useCallback(async t=>{try{const a=(await P.get(`/market/${t}`)).data.market;U(t,{shared_pool_liquidity:Number(a.shared_pool_liquidity||0),total_shared_lp_shares:Number(a.total_shared_lp_shares||0),accumulated_lp_fees:Number(a.accumulated_lp_fees||0)})}catch(s){console.error("Failed to reload pool:",s)}},[U]),de=async()=>{T(),S&&await Q(S),D(!1),q(null)},ce=async()=>{T(),S&&await Q(S),V(!1),q(null)},ue=k.reduce((t,s)=>t+(Number(s.shared_pool_liquidity)||0)/1e6+(Number(s.accumulated_lp_fees)||0)/1e6,0),me=k.reduce((t,s)=>t+(Number(s.accumulated_lp_fees)||0)/1e6,0),I=t=>{if(t>=1e6){const s=t/1e6,a=Math.round(s*100)/100;return`$${a.toFixed(a%1===0?0:2)}M`}if(t>=1e3){const s=t/1e3,a=Math.round(s*100)/100;return`$${a.toFixed(a%1===0?0:2)}k`}return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)};return e.jsxs("div",{className:"min-h-screen bg-ink-black relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_80%_50%_at_50%_-20%,rgba(124,77,255,0.1),transparent_50%)]"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_50%_40%_at_90%_100%,rgba(33,246,210,0.06),transparent_40%)]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.02] hidden sm:block",style:{backgroundImage:`linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                             linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px)`,backgroundSize:"60px 60px"}})]}),e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-neon-iris/20 to-transparent z-10"}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12 pb-24 lg:pb-12",children:[e.jsxs(N.div,{className:"mb-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6 mb-8",children:[e.jsxs("div",{children:[e.jsxs(N.div,{className:"inline-flex items-center gap-3 mb-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[e.jsx("div",{className:"h-px w-8 bg-gradient-to-r from-transparent to-aqua-pulse/60"}),e.jsx("span",{className:"text-[10px] tracking-[0.2em] uppercase text-moon-grey/60 font-medium",children:"Liquidity Pools"})]}),e.jsx("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-extralight text-white tracking-tight",children:"Pools"})]}),e.jsxs("div",{className:"flex items-center gap-6 lg:gap-10",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-1",children:"Total Value Locked"}),e.jsx("div",{className:"text-xl sm:text-2xl font-light text-white tabular-nums",children:I(ue)})]}),e.jsx("div",{className:"w-px h-10 bg-white/10"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-1",children:"Fees Earned"}),e.jsx("div",{className:"text-xl sm:text-2xl font-light text-aqua-pulse tabular-nums",children:I(me)})]}),e.jsx("div",{className:"w-px h-10 bg-white/10"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-1",children:"Active Pools"}),e.jsx("div",{className:"text-xl sm:text-2xl font-light text-white tabular-nums",children:k.length})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center border border-white/[0.08] bg-white/[0.02]",children:[e.jsx("button",{onClick:()=>v("all"),className:`px-4 py-2 text-[10px] tracking-[0.1em] uppercase font-medium transition-all ${g==="all"?"bg-white/[0.08] text-white":"text-moon-grey/60 hover:text-white hover:bg-white/[0.04]"}`,children:"All Pools"}),m&&e.jsxs("button",{onClick:()=>v("my-pools"),className:`px-4 py-2 text-[10px] tracking-[0.1em] uppercase font-medium transition-all ${g==="my-pools"?"bg-white/[0.08] text-white":"text-moon-grey/60 hover:text-white hover:bg-white/[0.04]"}`,children:["My Pools (",C.length,")"]})]}),e.jsxs("div",{className:"flex items-center border border-white/[0.08] bg-white/[0.02]",children:[e.jsx("button",{onClick:()=>h("admin"),className:`px-4 py-2 text-[10px] tracking-[0.1em] uppercase font-medium transition-all ${p==="admin"?"bg-neon-iris/20 text-neon-iris border-r border-neon-iris/30":"text-moon-grey/60 hover:text-white hover:bg-white/[0.04]"}`,children:"Official"}),e.jsx("button",{onClick:()=>h("user"),className:`px-4 py-2 text-[10px] tracking-[0.1em] uppercase font-medium transition-all ${p==="user"?"bg-neon-iris/20 text-neon-iris border-r border-neon-iris/30":"text-moon-grey/60 hover:text-white hover:bg-white/[0.04]"}`,children:"Community"}),e.jsx("button",{onClick:()=>h("all"),className:`px-4 py-2 text-[10px] tracking-[0.1em] uppercase font-medium transition-all ${p==="all"?"bg-neon-iris/20 text-neon-iris":"text-moon-grey/60 hover:text-white hover:bg-white/[0.04]"}`,children:"All"})]}),e.jsx("select",{value:o,onChange:t=>c(t.target.value),className:"px-4 py-2 text-[10px] tracking-[0.1em] uppercase font-medium bg-white/[0.02] text-moon-grey border border-white/[0.08] hover:bg-white/[0.04] transition-all focus:outline-none focus:border-neon-iris/30 cursor-pointer appearance-none pr-8",style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.5rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.5em 1.5em"},children:re.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))}),e.jsxs("select",{value:l,onChange:t=>A(t.target.value),className:"px-4 py-2 text-[10px] tracking-[0.1em] uppercase font-medium bg-white/[0.02] text-moon-grey border border-white/[0.08] hover:bg-white/[0.04] transition-all focus:outline-none focus:border-neon-iris/30 cursor-pointer appearance-none pr-8",style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.5rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.5em 1.5em"},children:[e.jsx("option",{value:"tvl",children:"Sort: TVL"}),e.jsx("option",{value:"apr",children:"Sort: APR"}),e.jsx("option",{value:"fees",children:"Sort: Fees"}),e.jsx("option",{value:"volume",children:"Sort: Volume"}),e.jsx("option",{value:"newest",children:"Sort: Newest"}),e.jsx("option",{value:"oldest",children:"Sort: Oldest"})]})]})]}),n?e.jsx(N.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",variants:ee,initial:"initial",animate:"animate",children:[1,2,3,4,5,6,7,8,9].map(t=>e.jsxs(N.div,{variants:te,className:"relative bg-graphite-deep/40 border border-white/[0.06] p-5",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"}),e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/[0.04] animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-white/[0.04] animate-pulse mb-2 w-3/4"}),e.jsx("div",{className:"h-3 bg-white/[0.04] animate-pulse w-1/2"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-3 bg-white/[0.04] animate-pulse"}),e.jsx("div",{className:"h-3 bg-white/[0.04] animate-pulse w-2/3"})]})]},t))}):R.length===0?e.jsxs(N.div,{className:"text-center py-20",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 border border-white/[0.08] bg-white/[0.02] mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-moon-grey/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsx("p",{className:"text-moon-grey/60 font-light",children:g==="my-pools"?"You haven't joined any pools yet":"No active pools found"})]}):e.jsxs(e.Fragment,{children:[e.jsx(N.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",variants:ee,initial:"initial",animate:"animate",children:R.map((t,s)=>{const a=H(t.id),d=E(t),_=(Number(t.shared_pool_liquidity)||0)/1e6+(Number(t.accumulated_lp_fees)||0)/1e6,j=(Number(t.accumulated_lp_fees)||0)/1e6;return e.jsxs(N.div,{variants:te,transition:{delay:s*.03},className:"group relative bg-graphite-deep/40 border border-white/[0.06] hover:border-neon-iris/20 transition-all duration-500",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent group-hover:via-neon-iris/30 transition-all duration-500"}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-5",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:"",className:"w-12 h-12 object-cover flex-shrink-0 ring-1 ring-white/10"}):e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-neon-iris/20 to-aqua-pulse/20 flex items-center justify-center flex-shrink-0 border border-white/[0.08]",children:e.jsx("span",{className:"text-white/60 font-light text-lg",children:t.question.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(ve,{to:`/market/${t.id}`,className:"text-white font-light hover:text-neon-iris transition-colors line-clamp-2 text-sm leading-snug block",children:t.question}),e.jsxs("div",{className:"text-[10px] tracking-wide text-moon-grey/50 mt-2 uppercase",children:[t.lp_count," Provider",t.lp_count!==1?"s":""]})]})]}),e.jsxs("div",{className:"space-y-3 mb-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/50",children:"TVL"}),e.jsx("span",{className:"text-sm font-light text-white tabular-nums",children:I(_)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/50",children:"Fees"}),e.jsx("span",{className:"text-sm font-light text-aqua-pulse tabular-nums",children:I(j)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/50",children:"APR"}),e.jsxs("span",{className:"text-sm font-light text-neon-iris tabular-nums",children:[d.toFixed(2),"%"]})]}),a&&e.jsx("div",{className:"pt-3 mt-3 border-t border-white/[0.06]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/50",children:"Your Position"}),e.jsx("span",{className:"text-sm font-light text-white tabular-nums",children:b(a.current_value)})]})})]}),e.jsx("div",{className:"flex gap-2",children:m?a?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>K(t.id),className:"flex-1 px-4 py-2.5 bg-neon-iris/10 hover:bg-neon-iris/20 text-neon-iris text-[10px] tracking-[0.1em] uppercase font-medium transition-all border border-neon-iris/20 hover:border-neon-iris/40",children:"Add"}),e.jsx("button",{onClick:()=>le(t.id),className:"flex-1 px-4 py-2.5 bg-white/[0.04] hover:bg-white/[0.08] text-white text-[10px] tracking-[0.1em] uppercase font-medium transition-all border border-white/[0.08] hover:border-white/[0.15]",children:"Remove"})]}):e.jsx("button",{onClick:()=>K(t.id),className:"w-full px-4 py-2.5 bg-neon-iris hover:bg-neon-iris/90 text-white text-[10px] tracking-[0.1em] uppercase font-medium transition-all",children:"Add Liquidity"}):e.jsx("button",{onClick:()=>M("/login"),className:"w-full px-4 py-2.5 bg-white/[0.04] hover:bg-white/[0.08] text-moon-grey hover:text-white text-[10px] tracking-[0.1em] uppercase font-medium transition-all border border-white/[0.08]",children:"Connect to Add Liquidity"})})]})]},t.id)})}),f&&e.jsx(N.div,{className:"flex justify-center mt-10",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:e.jsx("button",{onClick:ne,disabled:x,className:"group px-8 py-3 text-[10px] tracking-[0.15em] uppercase font-medium text-moon-grey hover:text-white border border-white/[0.08] hover:border-white/[0.15] bg-white/[0.02] hover:bg-white/[0.04] transition-all disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center gap-3",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border border-moon-grey/40 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Loading"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Load More"}),e.jsx("svg",{className:"w-3 h-3 transition-transform group-hover:translate-y-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]})})})]}),se&&S&&m&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx(N.div,{className:"absolute inset-0 bg-ink-black/80 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},onClick:()=>{D(!1),q(null)}}),e.jsxs(N.div,{className:"relative bg-graphite-deep border border-white/[0.08] p-6 max-w-md w-full shadow-2xl",initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},transition:{duration:.3},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-neon-iris/40 to-transparent"}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-light text-white tracking-tight",children:"Add Liquidity"}),e.jsx("button",{onClick:()=>{D(!1),q(null)},className:"text-moon-grey/60 hover:text-white transition-colors p-1",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(we,{marketId:S,onAdded:de})]})]}),ae&&S&&m&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx(N.div,{className:"absolute inset-0 bg-ink-black/80 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},onClick:()=>{V(!1),q(null)}}),e.jsxs(N.div,{className:"relative bg-graphite-deep border border-white/[0.08] p-6 max-w-md w-full shadow-2xl",initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},transition:{duration:.3},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-neon-iris/40 to-transparent"}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-light text-white tracking-tight",children:"Remove Liquidity"}),e.jsx("button",{onClick:()=>{V(!1),q(null)},className:"text-moon-grey/60 hover:text-white transition-colors p-1",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(je,{marketId:S,onRemoved:ce})]})]})]})]})};export{_e as Pools};
