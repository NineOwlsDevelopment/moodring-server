import{r,bi as S,t as p,j as e,m as l,L as f,b9 as c,A as I,bj as A}from"./index-4FQH80kW.js";const $=()=>{const[m,N]=r.useState([]),[o,h]=r.useState({total:0,page:1,limit:50,offset:0,has_more:!1}),[w,u]=r.useState(!0),[g,b]=r.useState(null),[d,k]=r.useState("all"),[_,C]=r.useState(null),[i,n]=r.useState({disputeId:null,status:"resolved",reviewNotes:""});r.useEffect(()=>{x()},[d]);const x=async()=>{var t,s;try{u(!0);const a=await S({page:o.page,limit:o.limit,status:d!=="all"?d:void 0});N(a.disputes),h(a.pagination)}catch(a){console.error("Failed to load disputes:",a),p.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to load disputes")}finally{u(!1)}},R=async()=>{var t,s;if(i.disputeId)try{b(i.disputeId),await A(i.disputeId,{status:i.status,review_notes:i.reviewNotes||void 0}),p.success("Dispute resolved successfully"),n({disputeId:null,status:"resolved",reviewNotes:""}),x()}catch(a){console.error("Failed to resolve dispute:",a),p.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to resolve dispute")}finally{b(null)}},y=t=>{switch(t){case"resolved":return"text-aqua-pulse border-aqua-pulse/30 bg-aqua-pulse/10";case"dismissed":return"text-moon-grey/50 border-white/10 bg-white/5";case"reviewed":return"text-neon-iris border-neon-iris/30 bg-neon-iris/10";default:return"text-amber-400 border-amber-400/30 bg-amber-400/10"}},v=t=>new Date(t*1e3).toLocaleString(),j=t=>(t/1e6).toFixed(2),D=[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"reviewed",label:"Reviewed"},{key:"resolved",label:"Resolved"},{key:"dismissed",label:"Dismissed"}];return e.jsxs("div",{className:"min-h-screen bg-ink-black",children:[e.jsx("div",{className:"fixed inset-0 pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_80%_50%_at_50%_-20%,rgba(124,77,255,0.08),transparent_60%)]"})}),e.jsxs("div",{className:"relative px-4 py-6 sm:p-6 lg:p-8",children:[e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6 sm:mb-10",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] tracking-[0.3em] uppercase text-neon-iris/80 font-medium mb-2 sm:mb-3",children:"Administration"}),e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-extralight tracking-tight text-white",children:"Disputes"})]}),e.jsxs("div",{className:"text-xs sm:text-sm text-moon-grey/50",children:[o.total," disputes"]})]}),e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:D.map(t=>e.jsx("button",{onClick:()=>k(t.key),className:`px-3 sm:px-4 py-2 text-[10px] sm:text-xs tracking-wide uppercase font-medium border transition-all duration-300 ${d===t.key?"bg-gradient-to-r from-neon-iris to-aqua-pulse text-white border-transparent":"bg-white/5 text-moon-grey/70 border-white/10 hover:border-white/20 hover:text-white"}`,children:t.label},t.key))})}),w?e.jsx("div",{className:"bg-graphite-deep/30 border border-white/5 flex items-center justify-center py-20",children:e.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-neon-iris rounded-full animate-spin"})}):m.length===0?e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-graphite-deep/30 border border-white/5 text-center py-20",children:e.jsx("p",{className:"text-moon-grey/40 text-sm font-light",children:"No disputes found"})}):e.jsxs(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-graphite-deep/30 border border-white/5",children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Market"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Option"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"User"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Reason"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Fee Paid"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Status"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Created"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:m.map(t=>e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/[0.02] transition-colors",children:[e.jsx("td",{className:"py-4 px-5",children:e.jsx(f,{to:`/market/${t.market_id}`,className:"text-sm text-neon-iris hover:text-neon-iris/80 font-light transition-colors line-clamp-1",children:t.market_question||c(t.market_id,8)})}),e.jsx("td",{className:"py-4 px-5",children:e.jsx("span",{className:"text-moon-grey/60 text-sm font-light",children:t.option_label||"N/A"})}),e.jsx("td",{className:"py-4 px-5",children:e.jsx("span",{className:"text-moon-grey/60 text-sm font-light",children:t.user_display_name||t.user_username||c(t.user_id,8)})}),e.jsx("td",{className:"py-4 px-5",children:e.jsx("span",{className:"text-moon-grey/40 text-sm font-light line-clamp-1 max-w-xs",children:t.reason})}),e.jsx("td",{className:"py-4 px-5",children:e.jsxs("span",{className:"text-moon-grey/60 text-sm font-light tabular-nums",children:["$",j(t.resolution_fee_paid)," USDC"]})}),e.jsx("td",{className:"py-4 px-5",children:e.jsx("span",{className:`px-2.5 py-1 text-[10px] tracking-[0.1em] uppercase font-medium border ${y(t.status)}`,children:t.status})}),e.jsx("td",{className:"py-4 px-5 text-moon-grey/40 text-sm font-light",children:v(t.created_at)}),e.jsx("td",{className:"py-4 px-5",children:t.status==="pending"?e.jsx("button",{onClick:()=>n({disputeId:t.id,status:"resolved",reviewNotes:""}),className:"text-[10px] tracking-[0.1em] uppercase text-neon-iris hover:text-neon-iris/80 font-medium transition-colors",children:"Resolve"}):e.jsx("span",{className:"text-moon-grey/30 text-[10px]",children:t.reviewer_username||t.reviewer_display_name?`By ${t.reviewer_display_name||t.reviewer_username}`:"N/A"})})]},t.id))})]})}),e.jsx("div",{className:"lg:hidden divide-y divide-white/5",children:m.map(t=>{const s=_===t.id;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between cursor-pointer",onClick:()=>C(s?null:t.id),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(f,{to:`/market/${t.market_id}`,onClick:a=>a.stopPropagation(),className:"text-sm text-neon-iris font-light line-clamp-2",children:t.market_question||c(t.market_id,8)}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:`px-2 py-0.5 text-[9px] tracking-[0.1em] uppercase font-medium border ${y(t.status)}`,children:t.status}),e.jsxs("span",{className:"text-[10px] text-moon-grey/40",children:["$",j(t.resolution_fee_paid)]})]})]}),e.jsx("span",{className:`text-moon-grey/40 transition-transform duration-200 inline-block text-xs ml-2 ${s?"rotate-180":""}`,children:"â–¼"})]}),e.jsx(I,{children:s&&e.jsx(l.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"pt-4 mt-4 border-t border-white/5 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-moon-grey/40",children:"User"}),e.jsx("div",{className:"text-white font-light mt-1",children:t.user_display_name||t.user_username||c(t.user_id,8)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-moon-grey/40",children:"Option"}),e.jsx("div",{className:"text-white font-light mt-1",children:t.option_label||"N/A"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-moon-grey/40",children:"Reason"}),e.jsx("div",{className:"text-white font-light mt-1",children:t.reason})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-moon-grey/40",children:"Created"}),e.jsx("div",{className:"text-white font-light mt-1",children:v(t.created_at)})]})]}),t.status==="pending"&&e.jsx("button",{onClick:a=>{a.stopPropagation(),n({disputeId:t.id,status:"resolved",reviewNotes:""})},className:"w-full py-2.5 text-xs tracking-wide uppercase font-medium bg-white text-ink-black hover:bg-moon-grey-light transition-all duration-300",children:"Resolve Dispute"})]})})})]},t.id)})}),o.has_more&&e.jsx("div",{className:"flex justify-center py-6 border-t border-white/5",children:e.jsx("button",{onClick:()=>{h(t=>({...t,page:t.page+1,offset:t.offset+t.limit})),x()},className:"px-6 py-2.5 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300",children:"Load More"})})]}),i.disputeId&&e.jsx("div",{className:"fixed inset-0 bg-ink-black/90 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>n({disputeId:null,status:"resolved",reviewNotes:""}),children:e.jsxs(l.div,{initial:{opacity:0,y:20,scale:.98},animate:{opacity:1,y:0,scale:1},onClick:t=>t.stopPropagation(),className:"relative bg-graphite-deep border border-white/5 max-w-lg w-full max-h-[90vh] overflow-y-auto p-5 sm:p-6",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-neon-iris/50 to-transparent"}),e.jsx("h2",{className:"text-lg sm:text-xl font-light text-white mb-5 sm:mb-6",children:"Resolve Dispute"}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-2 sm:mb-3",children:"Resolution Status"}),e.jsxs("select",{value:i.status,onChange:t=>n(s=>({...s,status:t.target.value})),className:"w-full bg-ink-black border border-white/10 px-3 sm:px-4 py-2.5 sm:py-3 text-sm text-white focus:outline-none focus:border-neon-iris/50 transition-colors",children:[e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"dismissed",children:"Dismissed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-2 sm:mb-3",children:"Review Notes"}),e.jsx("textarea",{value:i.reviewNotes,onChange:t=>n(s=>({...s,reviewNotes:t.target.value})),placeholder:"Add review notes (optional)...",className:"w-full bg-ink-black border border-white/10 px-3 sm:px-4 py-2.5 sm:py-3 text-sm text-white placeholder-moon-grey/40 focus:outline-none focus:border-neon-iris/50 transition-colors resize-none",rows:4})]})]}),e.jsxs("div",{className:"flex gap-3 mt-5 sm:mt-6",children:[e.jsx("button",{onClick:()=>n({disputeId:null,status:"resolved",reviewNotes:""}),className:"flex-1 py-2.5 sm:py-3 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300",children:"Cancel"}),e.jsx("button",{onClick:R,disabled:g===i.disputeId,className:"flex-1 py-2.5 sm:py-3 text-xs tracking-wide uppercase font-medium bg-white text-ink-black hover:bg-moon-grey-light transition-all duration-300 disabled:opacity-50",children:g===i.disputeId?"Resolving...":"Submit Resolution"})]})]})})]})]})};export{$ as AdminDisputes};
