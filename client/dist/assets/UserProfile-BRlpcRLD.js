import{c as S,r as o,K as $e,j as e,X as ae,V as he,W as Be,d as Ye,a4 as ue,b as ze,t as w,aD as Ue,aE as Ve,aF as De,aG as Ie,aH as He,aI as Qe,L as me,aJ as We,ai as te,aK as Ge,aL as _e,aM as ce,aN as Je,aO as Xe,w as re,aP as Ze,aQ as Oe,aR as es,aS as ss,aT as ts}from"./index-CyUWOdn5.js";import{A as as}from"./arrow-left-DfHiNuk1.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],is=S("arrow-down-right",rs);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],ns=S("arrow-up-right",ls);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],ds=S("award",os);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],xs=S("circle-plus",cs);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],ms=S("ellipsis-vertical",hs);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],gs=S("external-link",us);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],bs=S("file-text",ps);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Se=S("heart",ys);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],fs=S("image",ws);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],O=S("key",js);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],vs=S("lock",Ns);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],ge=S("message-circle",ks);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],$s=S("share-2",_s);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Ce=S("trending-down",Ss);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],qs=S("video",Cs),Ps=({isOpen:t,onClose:l,imageUrl:m,alt:s="Image"})=>{if(o.useEffect(()=>{if(!t)return;const r=g=>{g.key==="Escape"&&l()};return document.addEventListener("keydown",r),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",r),document.body.style.overflow=""}},[t,l]),!t)return null;const x=()=>document.getElementById("root")||document.body;return $e.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",onClick:l,children:[e.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-sm"}),e.jsxs("div",{className:"relative max-w-7xl max-h-[95vh] w-full h-full flex items-center justify-center",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 z-10 w-10 h-10 flex items-center justify-center text-white hover:text-neon-iris bg-black/50 hover:bg-black/70 rounded-full transition-all backdrop-blur-sm","aria-label":"Close image",children:e.jsx(ae,{className:"w-6 h-6"})}),e.jsx("img",{src:m,alt:s,className:"max-w-full max-h-[95vh] object-contain rounded-lg",onClick:r=>r.stopPropagation()})]})]}),x())};function Z(t){return t<0?0:t*t/16e3}function Fs(t,l){if(l<=0)return 0;t<0&&(t=0);const m=t+l,s=(Math.pow(m,3)-Math.pow(t,3))/48e3;return Math.max(0,s)}function Ms(t,l){if(l<=0||t<=0)return 0;t<l&&(l=t);const m=t,s=t-l,x=(Math.pow(m,3)-Math.pow(s,3))/48e3;return Math.max(0,x)}const Ls=({isOpen:t,onClose:l,traderName:m,currentSupply:s,currentPrice:x,keyOwnership:r,isTrader:g=!1,onBuy:C,onSell:E})=>{const[u,R]=o.useState("buy"),[d,N]=o.useState(1e-6),[q,K]=o.useState(!1);if(o.useEffect(()=>{if(u==="sell"){const f=g?Math.max(0,s-1):r;N(Math.min(1e-6,f))}else N(1e-6)},[u,r,g,s]),o.useEffect(()=>{if(!t)return;const f=P=>{P.key==="Escape"&&l()};return document.addEventListener("keydown",f),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",f),document.body.style.overflow=""}},[t,l]),!t)return null;const j=Math.max(1,s),T=u==="buy"?Fs(j,d):0,$=u==="sell"?Ms(j,d):0,B=u==="buy"?d>0?T/d:0:d>0?$/d:0,I=u==="buy"?j+d:j-d,Y=Z(I),_=Y-(x||Z(j)),A=(x||Z(j))>0?_/(x||Z(j))*100:0,z=async()=>{if(!q&&!(u==="buy"&&d<=1e-6)){if(u==="sell"){if(d<=1e-6)return;if(g){const f=Math.max(0,j-1);if(d>f+1e-6)return}else if(d>r+1e-6)return}K(!0);try{u==="buy"?await C(d):await E(d),l(),N(1e-6)}catch(f){console.error("Transaction failed:",f)}finally{K(!1)}}},H=()=>document.getElementById("root")||document.body;return $e.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",onClick:l,children:[e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),e.jsxs("div",{className:"relative bg-graphite-deep rounded-2xl border border-white/10 p-6 max-w-md w-full shadow-2xl animate-scale-in",onClick:f=>f.stopPropagation(),children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 w-8 h-8 flex items-center justify-center text-moon-grey hover:text-white transition-colors rounded-lg hover:bg-white/5","aria-label":"Close",children:e.jsx(ae,{className:"w-5 h-5"})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(O,{className:"w-5 h-5 text-neon-iris"}),e.jsxs("h2",{className:"text-xl font-bold text-white",children:[m||"Trader"," Keys"]})]}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Current Supply: ",j.toFixed(6)," ",g&&"(1 unsellable founder key)"]})]}),e.jsxs("div",{className:"flex gap-2 mb-6 bg-white/5 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>R("buy"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all ${u==="buy"?"bg-neon-iris text-white":"text-gray-400 hover:text-white"}`,children:"Buy"}),e.jsxs("button",{onClick:()=>R("sell"),disabled:!g&&r===0,className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all ${u==="sell"?"bg-aqua-pulse text-white":"text-gray-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed"}`,children:["Sell"," ",g?`(${Math.max(0,j-1)} sellable)`:r>0&&`(${r})`]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Current Price"}),e.jsxs("span",{className:"text-lg font-bold text-white",children:["$",(x||Z(j)).toFixed(4)]})]}),u==="buy"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Price After"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-semibold text-white",children:["$",Y.toFixed(4)]}),_!==0&&e.jsxs("span",{className:`text-xs flex items-center gap-1 ${_>0?"text-aqua-pulse":"text-brand-danger"}`,children:[_>0?e.jsx(he,{className:"w-3 h-3"}):e.jsx(Ce,{className:"w-3 h-3"}),A>0?"+":"",A.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:u==="buy"?"Quantity to Buy":"Quantity to Sell"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{const f=Math.max(1e-6,d-1e-6);N(parseFloat(f.toFixed(6)))},disabled:d<=1e-6||q,className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"-"}),e.jsx("input",{type:"number",min:1e-6,step:1e-6,max:u==="sell"?g?Math.max(0,j-1):r:void 0,value:d,onChange:f=>{const P=parseFloat(f.target.value)||1e-6;if(isNaN(P)||P<1e-6){N(1e-6);return}const p=parseFloat(P.toFixed(6));if(u==="sell")if(g){const c=Math.max(0,j-1);N(Math.min(p,c))}else N(Math.min(p,r));else N(p)},className:"flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-center focus:outline-none focus:ring-2 focus:ring-neon-iris",disabled:q}),e.jsx("button",{onClick:()=>{const f=d+1e-6,P=parseFloat(f.toFixed(6));if(u==="sell")if(g){const p=Math.max(0,j-1);N(Math.min(P,p))}else N(Math.min(P,r));else N(P)},disabled:q||u==="sell"&&(g?d>=Math.max(0,j-1):d>=r),className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"+"})]}),u==="sell"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 text-center",children:g?`You can sell up to ${Math.max(0,j-1).toFixed(6)} key(s) (must keep 1 founder key)`:r>0&&`You own ${r.toFixed(6)} key${r!==1?"s":""}`})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 mb-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Average Price"}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:["$",B.toFixed(4)]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-white/10",children:[e.jsx("span",{className:"text-base font-semibold text-white",children:u==="buy"?"Total Cost":"Total Payout"}),e.jsxs("span",{className:`text-lg font-bold ${u==="buy"?"text-aqua-pulse":"text-brand-danger"}`,children:[u==="buy"?"-":"+","$",(u==="buy"?T:$).toFixed(4)]})]})]}),e.jsx("button",{onClick:z,disabled:q||d<=1e-6||u==="sell"&&(g?d>Math.max(0,j-1)+1e-6:d>r+1e-6),className:`w-full py-3 rounded-lg font-semibold text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${u==="buy"?"bg-neon-iris hover:bg-neon-iris/90":"bg-aqua-pulse hover:bg-aqua-pulse/90"}`,children:q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4"}),u==="buy"?`Buy ${d.toFixed(6)} Key${d!==1?"s":""}`:`Sell ${d.toFixed(6)} Key${d!==1?"s":""}`]})})]})]}),H())},Rs=({name:t,imageUrl:l,size:m="xl"})=>{const s={lg:"w-20 h-20 text-2xl",xl:"w-24 h-24 text-3xl","2xl":"w-32 h-32 text-4xl"},x=["bg-neon-iris/20 text-neon-iris border-neon-iris/30","bg-aqua-pulse/20 text-aqua-pulse border-aqua-pulse/30","bg-graphite-light text-moon-grey border-white/10","bg-white/10 text-white border-white/20"],r=t.charCodeAt(0)%x.length;return l?e.jsx("img",{src:l,alt:t,className:`${s[m]} rounded-full object-cover border-2 border-white/10`}):e.jsx("div",{className:`${s[m]} rounded-full ${x[r]} border-2 flex items-center justify-center font-semibold`,children:t.charAt(0).toUpperCase()})},qe=({name:t,size:l="md",imageUrl:m})=>{const s={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base"},x=["bg-neon-iris/20 text-neon-iris border-neon-iris/30","bg-aqua-pulse/20 text-aqua-pulse border-aqua-pulse/30","bg-graphite-light text-moon-grey border-white/10"],r=t.charCodeAt(0)%x.length;return e.jsx("div",{className:"relative flex-shrink-0",children:m?e.jsx("img",{src:m,alt:t,className:`${s[l]} rounded-full object-cover border border-white/10`}):e.jsx("div",{className:`${s[l]} rounded-full ${x[r]} border flex items-center justify-center font-semibold`,children:t.charAt(0).toUpperCase()})})},Es=({isLiked:t,likesCount:l,commentsCount:m,onLike:s,onComment:x,onShare:r})=>e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsxs("button",{onClick:s,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl transition-all duration-300 min-h-[44px] group ${t?"bg-brand-danger/15 text-brand-danger hover:bg-brand-danger/20":"hover:bg-white/5 text-moon-grey hover:text-brand-danger"}`,children:[e.jsx(Se,{className:`w-5 h-5 transition-all duration-300 ${t?"scale-110 fill-current":"group-hover:scale-110"}`}),e.jsx("span",{className:"text-sm font-semibold tabular-nums",children:l})]}),e.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2.5 rounded-xl hover:bg-white/5 text-moon-grey hover:text-neon-iris transition-all min-h-[44px] group",children:[e.jsx(ge,{className:"w-5 h-5 group-hover:scale-110 transition-transform duration-300"}),e.jsx("span",{className:"text-sm font-semibold tabular-nums",children:m})]})]}),e.jsx("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2.5 rounded-xl hover:bg-white/5 text-moon-grey hover:text-aqua-pulse transition-all min-h-[44px] group",children:e.jsx($s,{className:"w-5 h-5 group-hover:scale-110 transition-transform duration-300"})})]}),Ks=({postId:t,isOpen:l,onReplyCreated:m})=>{const[s,x]=o.useState([]),[r,g]=o.useState(new Map),[C,E]=o.useState(new Set),[u,R]=o.useState(new Set),[d,N]=o.useState(!1),[q,K]=o.useState(""),[j,T]=o.useState(!1),[$,B]=o.useState(null),I=o.useRef(null);o.useEffect(()=>{l&&Y()},[l,t]);const Y=async()=>{N(!0);try{const{comments:c}=await Oe(t,{limit:50});x(c)}catch(c){console.error("Failed to load comments:",c)}finally{N(!1)}},_=async c=>{if(!(r.has(c)||u.has(c))){R(n=>new Set(n).add(c));try{const{replies:n}=await ss(c,{limit:50});g(y=>{const b=new Map(y);return b.set(c,n),b})}catch(n){console.error("Failed to load replies:",n)}finally{R(n=>{const y=new Set(n);return y.delete(c),y})}}},A=c=>{C.has(c)?E(n=>{const y=new Set(n);return y.delete(c),y}):(E(n=>new Set(n).add(c)),_(c))},z=async()=>{var c,n;if(!(!q.trim()||j)){T(!0);try{await es({post_id:t,content:q.trim(),parent_comment_id:($==null?void 0:$.id)||void 0}),K(""),B(null),Y(),$!=null&&$.id&&(g(y=>{const b=new Map(y);return b.delete($.id),b}),_($.id)),m(),w.success("Reply posted!")}catch(y){w.error(((n=(c=y.response)==null?void 0:c.data)==null?void 0:n.error)||"Failed to post reply")}finally{T(!1)}}},H=(c,n,y)=>{var k;const b=n||y;B({id:c,name:b}),K(`@${b} `),(k=I.current)==null||k.focus()},f=async c=>{var n,y;try{const b=await ts(c);x(k=>k.map(F=>F.id===c?{...F,is_liked:b.liked,likes_count:b.likes_count}:F)),g(k=>{const F=new Map(k);for(const[U,X]of F.entries()){const V=X.map(Q=>Q.id===c?{...Q,is_liked:b.liked,likes_count:b.likes_count}:Q);F.set(U,V)}return F})}catch(b){w.error(((y=(n=b.response)==null?void 0:n.data)==null?void 0:y.error)||"Failed to like comment")}},P=(c,n,y=[])=>{for(const b of c){y.push({comment:b,parent:n,depth:n?1:0});const k=r.get(b.id);k&&C.has(b.id)&&P(k,b,y)}return y},p=c=>{const{comment:n,parent:y,depth:b}=c,k=r.get(n.id),F=r.has(n.id),U=k&&k.length>0,X=C.has(n.id),V=!!y;return e.jsxs("div",{className:`relative pr-3 py-3 hover:bg-graphite-light transition-colors border-b border-white/5 last:border-b-0 ${V?"pl-12 ml-8":"pl-3"}`,children:[V&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-px bg-white/10"}),e.jsx("div",{className:"absolute left-0 top-[18px] w-8 h-px bg-white/10"})]}),e.jsxs("div",{className:"flex gap-3 relative",children:[e.jsx("div",{className:"flex-shrink-0 relative",children:e.jsx(qe,{name:n.display_name||n.username,size:"sm",imageUrl:n.avatar_url||void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[y&&e.jsx("div",{className:"mb-1.5",children:e.jsxs("span",{className:"text-xs text-moon-grey-dark",children:["Replying to"," ",e.jsx("span",{className:"font-medium text-moon-grey",children:y.display_name||y.username})]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-semibold text-sm text-white",children:n.display_name||n.username}),b===0&&e.jsxs("span",{className:"text-xs text-moon-grey-dark",children:["@",n.username]}),e.jsx("span",{className:"text-xs text-moon-grey-dark",children:n.created_at?re(Number(n.created_at)):"now"})]}),e.jsx("p",{className:"text-sm text-moon-grey-light mt-1 whitespace-pre-wrap leading-relaxed",children:n.content}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("button",{onClick:()=>f(n.id),className:`flex items-center gap-1.5 text-xs transition-colors font-medium ${n.is_liked?"text-brand-danger hover:text-brand-danger/80":"text-moon-grey-dark hover:text-brand-danger"}`,children:[e.jsx(Se,{className:`w-3.5 h-3.5 ${n.is_liked?"fill-current":""}`}),n.likes_count!==void 0&&n.likes_count>0?n.likes_count:""]}),e.jsx("button",{onClick:()=>H(n.id,n.display_name,n.username),className:"text-xs text-moon-grey-dark hover:text-neon-iris transition-colors font-medium",children:"Reply"}),e.jsx("button",{onClick:()=>A(n.id),className:"text-xs text-moon-grey-dark hover:text-neon-iris transition-colors font-medium",children:X?"Hide replies":F&&U?`${k.length} ${k.length===1?"reply":"replies"}`:F&&!U?"No replies":"View replies"})]})]})]})]},n.id)};return l?e.jsxs("div",{className:"border-t border-white/5 bg-graphite-deep",children:[e.jsxs("div",{className:"p-5 border-b border-white/5",children:[$&&e.jsxs("div",{className:"mb-3 px-3 py-2 bg-graphite-light border border-white/10 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"text-moon-grey-dark",children:"Replying to"}),e.jsx("span",{className:"text-neon-iris font-semibold",children:$.name})]}),e.jsx("button",{onClick:()=>{B(null),K("")},className:"p-1 rounded-lg hover:bg-graphite-hover text-moon-grey hover:text-white transition-all",children:e.jsx(ae,{className:"w-3.5 h-3.5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{ref:I,value:q,onChange:c=>K(c.target.value),onKeyDown:c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),z())},placeholder:$?`Reply to ${$.name}...`:"Write a reply...",rows:q.split(`
`).length+1,className:"w-full bg-graphite-light border border-white/10 rounded-lg px-4 py-3 text-sm text-white placeholder-moon-grey-dark focus:outline-none focus:ring-2 focus:ring-neon-iris/30 focus:border-neon-iris/50 focus:bg-graphite-hover transition-all resize-none min-h-[44px] max-h-32 leading-relaxed"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Press Enter to reply, Shift+Enter for new line"}),e.jsx("button",{onClick:z,disabled:!q.trim()||j,className:"px-5 py-2 rounded-lg bg-neon-iris text-white text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-neon-iris-light transition-all flex items-center gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-3.5 h-3.5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Posting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{children:"Reply"})]})})]})]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:d?e.jsx("div",{className:"p-5 text-center text-moon-grey-dark text-sm",children:"Loading comments..."}):s.length===0?e.jsx("div",{className:"p-5 text-center text-moon-grey-dark text-sm",children:"No replies yet"}):e.jsx("div",{children:P(s).map(c=>e.jsx("div",{children:p(c)},c.comment.id))})})]}):null},As=({post:t,onLike:l,onToggleReplies:m,showReplies:s,onReplyCreated:x,profile:r,onImageClick:g})=>{const C=async()=>{try{await navigator.clipboard.writeText(window.location.origin+`/post/${t.id}`),w.success("Link copied!")}catch{w.error("Failed to copy link")}};return e.jsxs("article",{className:"bg-graphite-deep border border-white/5 rounded-lg transition-all duration-200 hover:border-white/10",children:[e.jsx("div",{className:"p-5 pb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(qe,{name:r.display_name||r.username,size:"md",imageUrl:r.avatar_url||void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-semibold text-white text-[15px]",children:r.display_name||r.username}),r.total_pnl>1e4&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold bg-neon-iris/20 text-neon-iris border border-neon-iris/30 rounded",children:"VIP"}),e.jsx("span",{className:"text-gray-500",children:"Â·"}),e.jsx("span",{className:"text-xs text-gray-500",children:t.created_at?re(Number(t.created_at)):"now"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["@",r.username]})]}),e.jsx("button",{className:"p-2 rounded-xl hover:bg-white/5 text-moon-grey-dark hover:text-white transition-all min-w-[40px] min-h-[40px] flex items-center justify-center",children:e.jsx(ms,{className:"w-5 h-5"})})]})}),t.market_question&&e.jsxs(me,{to:`/market/${t.market_id}`,className:"mx-5 mb-4 flex items-center gap-2.5 px-3 py-2 bg-graphite-light border border-white/10 rounded-lg transition-all group hover:border-neon-iris/30",children:[e.jsx(te,{className:"w-4 h-4 text-neon-iris flex-shrink-0"}),e.jsx("span",{className:"text-sm text-moon-grey-light group-hover:text-white line-clamp-1 font-medium flex-1",children:t.market_question}),e.jsx("svg",{className:"w-4 h-4 text-moon-grey ml-auto flex-shrink-0 group-hover:text-neon-iris group-hover:translate-x-0.5 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),e.jsx("div",{className:"px-5 pb-4 relative",children:e.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap text-sm",children:t.content})}),t.image_url&&e.jsx("div",{className:"relative mx-5 mb-4 rounded-lg overflow-hidden border border-white/10",children:e.jsx("img",{src:t.image_url,alt:"Post attachment",loading:"lazy",className:"w-full max-h-[500px] object-cover max-w-full cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>g==null?void 0:g(t.image_url)})}),t.video_url&&e.jsx("div",{className:"relative mx-5 mb-4 rounded-lg overflow-hidden border border-white/10 bg-graphite-light",onClick:E=>E.stopPropagation(),children:e.jsx("video",{src:t.video_url,controls:!0,className:"w-full max-h-[500px] object-contain max-w-full",preload:"metadata",children:"Your browser does not support the video tag."})}),e.jsx("div",{className:"px-5 pb-4",children:e.jsx(Es,{isLiked:t.is_liked||!1,likesCount:t.likes_count,commentsCount:t.comments_count,onLike:l,onComment:m,onShare:C})}),e.jsxs("button",{onClick:m,className:"w-full px-5 py-3 bg-graphite-light border-t border-white/5 text-sm text-moon-grey hover:text-white hover:bg-graphite-hover transition-all flex items-center gap-2 font-medium",children:[e.jsx(ge,{className:"w-4 h-4 text-neon-iris"}),s?"Hide replies":t.comments_count>0?`View ${t.comments_count} ${t.comments_count===1?"reply":"replies"}`:"Reply"]}),e.jsx(Ks,{postId:t.id,isOpen:s,onReplyCreated:x})]})},Ts=({activeTab:t,onTabChange:l,postsCount:m,showTradesTab:s})=>{const x=[{id:"posts",label:"Posts",count:m},{id:"markets",label:"Markets"},...s?[{id:"trades",label:"Trades"}]:[]];return e.jsx("div",{className:"flex border-b border-white/10 gap-1",children:x.map(r=>e.jsxs("button",{onClick:()=>l(r.id),className:`px-4 py-3 text-sm font-medium transition-all relative ${t===r.id?"text-white":"text-moon-grey hover:text-white"}`,children:[r.label,r.count!==void 0&&e.jsxs("span",{className:"ml-1.5 text-xs text-moon-grey-dark",children:["(",r.count,")"]}),t===r.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-neon-iris"})]},r.id))})},xe=({icon:t,title:l,subtitle:m})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-graphite-deep border border-white/10 flex items-center justify-center mb-4",children:e.jsx(t,{className:"w-8 h-8 text-moon-grey"})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:l}),e.jsx("p",{className:"text-moon-grey-dark text-sm text-center",children:m})]}),Bs=()=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-32 bg-graphite-deep border-b border-white/5"}),e.jsxs("div",{className:"px-4 -mt-12",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-graphite-light mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-6 w-40 bg-graphite-light rounded"}),e.jsx("div",{className:"h-4 w-24 bg-graphite-light rounded"}),e.jsx("div",{className:"h-4 w-full bg-graphite-light rounded"})]})]})]}),Ys=()=>e.jsxs("div",{className:"bg-graphite-deep border border-white/5 rounded-lg animate-pulse",children:[e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-3 w-32 bg-graphite-light rounded"}),e.jsx("div",{className:"h-4 w-full bg-graphite-light rounded"}),e.jsx("div",{className:"h-4 w-3/4 bg-graphite-light rounded"})]}),e.jsx("div",{className:"h-48 bg-graphite-light"})]}),zs=({market:t,onImageClick:l})=>{const m=ue();let s=[];if(t.is_binary&&t.options&&t.options.length>0){const x=t.options[0],r=x.yes_price??.5,g=x.no_price??1-r;s=[{option:x,side:"yes",price:r},{option:x,side:"no",price:g}]}else t.options&&t.options.length>0&&(s=t.options.slice(0,2).map(x=>({option:x,side:"other",price:x.yes_price??.5})));return e.jsx("article",{className:"px-4 py-3 hover:bg-white/[0.02] transition-colors cursor-pointer border-b border-white/5",onClick:()=>m(`/market/${t.id}`),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-graphite-light border border-white/10 flex items-center justify-center",children:e.jsx(xs,{className:"w-5 h-5 text-neon-iris"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"text-[15px] font-semibold text-white",children:"Created market"}),e.jsx("span",{className:"text-gray-500",children:"Â·"}),e.jsx("span",{className:"text-[15px] text-gray-500",children:t.created_at?re(Number(t.created_at)):"now"})]}),e.jsx("p",{className:"text-[15px] text-white leading-5 mb-3",children:t.question}),e.jsxs("div",{className:"flex gap-3 mb-2",children:[t.image_url&&e.jsx("div",{className:"flex-shrink-0 w-24 h-24 rounded-xl overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",onClick:x=>{x.stopPropagation(),l==null||l(t.image_url)},children:e.jsx("img",{src:t.image_url,alt:"",className:"w-full h-full object-cover",loading:"lazy"})}),s.length>0&&e.jsxs("div",{className:"flex-1 flex flex-col gap-1.5 min-w-0",children:[s.map((x,r)=>{const{option:g,side:C,price:E}=x,u=C==="yes",R=C==="no",d=u?"Yes":R?"No":g.option_label;return e.jsxs("div",{className:`flex items-center gap-2 px-2 py-1.5 rounded-lg hover:bg-graphite-light transition-colors border ${u?"bg-aqua-pulse/10 border-aqua-pulse/20":R?"bg-brand-danger/10 border-brand-danger/20":"bg-graphite-light border-white/10"}`,onClick:N=>{N.stopPropagation(),m(`/market/${t.id}`)},children:[g.option_image_url?e.jsx("img",{src:g.option_image_url,alt:"",className:"w-4 h-4 rounded object-cover flex-shrink-0"}):e.jsx("div",{className:`w-4 h-4 rounded flex-shrink-0 ${u?"bg-emerald-500/20":R?"bg-rose-500/20":"bg-white/10"}`}),e.jsx("span",{className:`text-[13px] flex-1 truncate font-medium ${u?"text-aqua-pulse":R?"text-brand-danger":"text-white"}`,children:d}),e.jsxs("span",{className:"text-[13px] text-moon-grey-dark flex-shrink-0",children:[(E*100).toFixed(0),"Â¢"]})]},`${g.id}-${C}-${r}`)}),!t.is_binary&&t.options&&t.options.length>2&&e.jsx("div",{className:"px-2 py-1",children:e.jsxs("span",{className:"text-[13px] text-gray-500",children:["+",t.options.length-2," more"]})})]})]})]})]})})},Us=({trade:t})=>{const l=ue(),m=t.action==="buy",s=t.side==="yes";return e.jsx("article",{className:"relative px-4 py-3 hover:bg-white/[0.02] transition-colors cursor-pointer border-b border-white/5",onClick:()=>t.market_id&&l(`/market/${t.market_id}`),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${m?"bg-aqua-pulse/20 text-aqua-pulse":"bg-brand-danger/20 text-brand-danger"}`,children:m?e.jsx(ns,{className:"w-5 h-5"}):e.jsx(is,{className:"w-5 h-5"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:`text-sm font-semibold ${m?"text-aqua-pulse":"text-brand-danger"}`,children:m?"Bought":"Sold"}),e.jsx("span",{className:"text-gray-500",children:"Â·"}),e.jsx("span",{className:"text-xs text-gray-500",children:t.created_at?re(Number(t.created_at)):"now"})]}),t.market_question&&e.jsx("p",{className:"text-white text-sm mb-2 line-clamp-2 leading-relaxed",children:t.market_question}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${s?"bg-emerald-500/20 text-emerald-400":"bg-rose-500/20 text-rose-400"}`,children:t.option_label||(s?"Yes":"No")}),e.jsxs("span",{className:"text-sm text-gray-400",children:[(t.shares/1e6).toFixed(2)," shares"]}),t.pricePerShare!==void 0&&e.jsxs("span",{className:"text-sm text-gray-400",children:["@ $",(t.pricePerShare*100).toFixed(2)]}),t.amount&&e.jsxs("span",{className:`text-sm font-semibold ml-auto ${m?"text-aqua-pulse":"text-brand-danger"}`,children:[m?"+":"-","$",(Math.abs(t.amount)/1e6).toFixed(2)]})]}),t.market_id&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-gray-500 hover:text-neon-iris transition-colors",children:[e.jsx("span",{children:"View market"}),e.jsx(gs,{className:"w-3 h-3"})]})]})]})})},Is=()=>{const{identifier:t}=Be(),{user:l}=Ye(),m=ue(),[s,x]=o.useState(null),[r,g]=o.useState([]),[C,E]=o.useState([]),[u,R]=o.useState([]),[d,N]=o.useState("posts"),[q,K]=o.useState(!0),[j,T]=o.useState(!0),[$,B]=o.useState(!1),[I,Y]=o.useState(!1),[_,A]=o.useState(!1),[z,H]=o.useState(!1),[f,P]=o.useState(null),[p,c]=o.useState(0),[n,y]=o.useState(!1),[b,k]=o.useState(1),[F,U]=o.useState(!1),[X,V]=o.useState(!1);o.useEffect(()=>{if(s!=null&&s.required_keys_to_follow){const a=s.required_keys_to_follow,i=Math.max(1,a-p);k(i)}},[s==null?void 0:s.required_keys_to_follow,p]);const[Q,pe]=o.useState(new Set),[W,be]=o.useState(""),[G,ie]=o.useState(null),[le,ne]=o.useState(null),[ye,we]=o.useState(!1),[fe,oe]=o.useState(null),M=(l==null?void 0:l.id)===t||(l==null?void 0:l.username)===t;o.useEffect(()=>{t&&(Pe(),de())},[t]),o.useEffect(()=>{s!=null&&s.id&&ee()},[s==null?void 0:s.id]),o.useEffect(()=>{s!=null&&s.id&&je()},[s==null?void 0:s.id]),o.useEffect(()=>{t&&d==="trades"&&(M||(s==null?void 0:s.required_keys_to_follow)===0||s!=null&&s.required_keys_to_follow&&p>=s.required_keys_to_follow)&&Ne()},[t,d,M,s==null?void 0:s.required_keys_to_follow,p]),o.useEffect(()=>{t&&d==="markets"&&(s!=null&&s.id)&&Me()},[t,d,s==null?void 0:s.id]);const Pe=async()=>{if(t){K(!0);try{const a=await ze.get(`/user/profile/${t}`);x(a.data.user)}catch(a){console.error("Failed to load profile:",a),w.error("Failed to load profile")}finally{K(!1)}}},je=async()=>{if(s!=null&&s.id){T(!0);try{const{posts:a}=await Ue(s.id);g(a)}catch(a){console.error("Failed to load posts:",a)}finally{T(!1)}}},ee=async()=>{if(s!=null&&s.id){y(!0);try{const[a,i]=await Promise.all([Ve(s.id),M?Promise.resolve({quantity:0}):De(s.id)]);P(a.price_in_usdc),c(i.quantity)}catch(a){console.error("Failed to load key info:",a)}finally{y(!1)}}},Ne=async()=>{var a,i;if(t){B(!0);try{const h=(s==null?void 0:s.id)||t,{trades:v}=await Ie(h,{page:1,limit:50});E(v)}catch(h){if(console.error("Failed to load trades:",h),((a=h.response)==null?void 0:a.status)===403){const v=(i=h.response)==null?void 0:i.data;(v==null?void 0:v.required_keys)!==void 0?w.error(`You need at least ${v.required_keys} key(s) to view trades. You have ${v.owned_keys||0}.`):w.error("You must have access to view this user's trades")}else w.error("Failed to load trades")}finally{B(!1)}}},Fe=async()=>{var a,i;if(!(!(s!=null&&s.id)||F)){U(!0);try{const h=await _e({trader_id:s.id,quantity:b});if(w.success(`Successfully purchased ${h.quantity} key(s)`),await ee(),s.required_keys_to_follow&&h.quantity+p>=s.required_keys_to_follow&&await Ne(),p===0&&h.quantity>=1&&!_)try{await ce(s.id),A(!0),await de()}catch(v){console.error("Auto-follow failed:",v)}}catch(h){console.error("Failed to buy keys:",h),w.error(((i=(a=h.response)==null?void 0:a.data)==null?void 0:i.message)||"Failed to buy keys")}finally{U(!1)}}},Me=async()=>{if(s!=null&&s.id){Y(!0);try{const{markets:a}=await He({creator:s.id,page:1,limit:50});R(a)}catch(a){console.error("Failed to load markets:",a),w.error("Failed to load markets")}finally{Y(!1)}}},de=async()=>{if(!(!t||!l||M))try{const a=(s==null?void 0:s.id)||t,{is_following:i}=await Qe(a);A(i)}catch(a){console.error("Failed to check follow status:",a)}},Le=async()=>{var i,h,v,se,J,ke;if(!t||z)return;const a=(s==null?void 0:s.required_keys_to_follow)||1;if(!_&&p<a){w.error(`You must purchase at least ${a} key(s) to follow this user. You currently have ${p}.`),d!=="trades"&&N("trades");return}H(!0);try{const D=(s==null?void 0:s.id)||t;_?(await Je(D),A(!1),x(L=>L?{...L,followers_count:L.followers_count-1}:null),w.success("Unfollowed")):(await ce(D),A(!0),x(L=>L?{...L,followers_count:L.followers_count+1}:null),w.success("Following! ðŸŽ‰"))}catch(D){if(((i=D.response)==null?void 0:i.status)===403){const L=(h=D.response)==null?void 0:h.data;(L==null?void 0:L.required_keys)!==void 0?(w.error(`You need to purchase at least ${L.required_keys} key(s) to follow this user. You currently have ${L.owned_keys||0} key(s).`),d!=="trades"&&N("trades")):w.error(((se=(v=D.response)==null?void 0:v.data)==null?void 0:se.message)||"You must purchase keys to follow this user")}else w.error(((ke=(J=D.response)==null?void 0:J.data)==null?void 0:ke.error)||"Action failed")}finally{H(!1)}},Re=async a=>{var i,h;try{const v=await Ze(a);g(se=>se.map(J=>J.id===a?{...J,is_liked:v.liked,likes_count:v.likes_count}:J))}catch(v){w.error(((h=(i=v.response)==null?void 0:i.data)==null?void 0:h.error)||"Failed to like post")}},Ee=a=>{Q.has(a)?pe(i=>{const h=new Set(i);return h.delete(a),h}):pe(i=>new Set(i).add(a))},Ke=a=>{g(i=>i.map(h=>h.id===a?{...h,comments_count:h.comments_count+1}:h))},ve=a=>{var v;const i=(v=a.target.files)==null?void 0:v[0];if(!i)return;if(!i.type.startsWith("image/")&&!i.type.startsWith("video/")){w.error("Please select an image or video file");return}if(i.size>100*1024*1024){w.error("File size must be less than 100MB");return}ie(i);const h=new FileReader;h.onloadend=()=>{ne(h.result)},h.readAsDataURL(i)},Ae=()=>{ie(null),ne(null)},Te=async()=>{var a,i;if(!W.trim()&&!G){w.error("Please add some content or media");return}if(!l){w.error("Please log in to create a post");return}we(!0);try{await Xe({content:W.trim()||"",media:G||void 0}),be(""),ie(null),ne(null),await je(),w.success("Post created!")}catch(h){console.error("Failed to create post:",h),w.error(((i=(a=h.response)==null?void 0:a.data)==null?void 0:i.error)||"Failed to create post")}finally{we(!1)}};return q?e.jsx("div",{className:"min-h-screen pb-20",children:e.jsx(Bs,{})}):s?e.jsxs("div",{className:"min-h-screen pb-20 md:pb-8 bg-ink-black",children:[e.jsxs("div",{className:"h-32 md:h-40 bg-graphite-deep border-b border-white/5 relative",children:[e.jsx("button",{onClick:()=>m(-1),className:"absolute top-4 left-4 p-2 rounded-lg bg-graphite-deep/80 backdrop-blur-sm text-moon-grey hover:text-white hover:bg-graphite-light border border-white/10 transition-all min-w-[40px] min-h-[40px] flex items-center justify-center",children:e.jsx(as,{className:"w-5 h-5"})}),M&&e.jsx(me,{to:"/settings",className:"absolute top-4 right-4 p-2 rounded-lg bg-graphite-deep/80 backdrop-blur-sm text-moon-grey hover:text-white hover:bg-graphite-light border border-white/10 transition-all min-w-[40px] min-h-[40px] flex items-center justify-center",children:e.jsx(We,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative max-w-4xl mx-auto px-4 sm:px-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 -mt-12 mb-8",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Rs,{name:s.display_name||s.username,imageUrl:s.avatar_url,size:"xl"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white break-words",children:s.display_name||s.username}),s.total_trades>100&&e.jsx("span",{title:"Verified trader",className:"flex-shrink-0",children:e.jsx(ds,{className:"w-5 h-5 text-neon-iris"})})]}),e.jsxs("p",{className:"text-moon-grey text-sm mb-1",children:["@",s.username]}),s.created_at&&e.jsxs("p",{className:"text-moon-grey text-sm mb-3",children:["Joined"," ",(()=>{const a=Number(s.created_at),i=new Date(a>1e11?a:a*1e3);return isNaN(i.getTime())?"recently":i.toLocaleDateString("en-US",{month:"long",year:"numeric"})})()]}),s.bio&&e.jsx("p",{className:"text-moon-grey-light text-sm leading-relaxed mb-4 break-words",children:s.bio}),e.jsxs("div",{className:"flex items-center gap-6 text-sm mb-3",children:[e.jsxs("button",{className:"hover:text-white transition-colors",children:[e.jsx("span",{className:"font-semibold text-white tabular-nums",children:s.following_count}),e.jsx("span",{className:"text-moon-grey ml-1.5",children:"Following"})]}),e.jsxs("button",{className:"hover:text-white transition-colors",children:[e.jsx("span",{className:"font-semibold text-white tabular-nums",children:s.followers_count}),e.jsx("span",{className:"text-moon-grey ml-1.5",children:"Followers"})]})]}),e.jsxs("div",{className:"flex gap-2 flex-col sm:flex-row",children:[!M&&l&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>V(!0),className:"px-4 py-2 rounded-lg font-medium text-sm transition-all border bg-neon-iris text-white border-neon-iris hover:bg-neon-iris-light flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),f!==null?`$${f.toFixed(4)}`:"View Keys"]}),e.jsx("button",{onClick:Le,disabled:z||p<((s==null?void 0:s.required_keys_to_follow)||1)&&!_,className:`px-4 py-2 rounded-lg font-medium text-sm transition-all border ${_?"bg-graphite-deep text-white border-white/10 hover:bg-graphite-light":p<((s==null?void 0:s.required_keys_to_follow)||1)?"bg-white/10 text-gray-400 border-white/5 cursor-not-allowed":"bg-aqua-pulse text-white border-aqua-pulse hover:bg-aqua-pulse/90"}`,title:p<((s==null?void 0:s.required_keys_to_follow)||1)&&!_?`Purchase at least ${(s==null?void 0:s.required_keys_to_follow)||1} key(s) to follow`:"",children:z?"...":_?"Following":p<((s==null?void 0:s.required_keys_to_follow)||1)?`Buy ${(s==null?void 0:s.required_keys_to_follow)||1} Key${((s==null?void 0:s.required_keys_to_follow)||1)>1?"s":""} to Follow`:"Follow"}),!_&&p<((s==null?void 0:s.required_keys_to_follow)||1)&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1 sm:mt-0 sm:ml-2 flex items-center gap-1",children:[e.jsx(O,{className:"w-3 h-3"}),e.jsxs("span",{children:[p," /"," ",(s==null?void 0:s.required_keys_to_follow)||1," keys required"]})]})]}),M&&e.jsx(me,{to:"/settings",className:"px-4 py-2 rounded-lg bg-graphite-deep text-white font-medium text-sm hover:bg-graphite-light border border-white/10 transition-all",children:"Edit Profile"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8",children:[e.jsx("div",{className:"bg-graphite-deep border border-white/5 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-neon-iris/10",children:e.jsx(te,{className:"w-4 h-4 text-neon-iris"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-moon-grey-dark uppercase tracking-wider",children:"Total Trades"}),e.jsx("div",{className:"text-2xl font-bold text-white tabular-nums",children:s.total_trades})]})]})}),e.jsx("div",{className:"bg-graphite-deep border border-white/5 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-aqua-pulse/10",children:e.jsx(te,{className:"w-4 h-4 text-aqua-pulse"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-moon-grey-dark uppercase tracking-wider",children:"Total Volume"}),e.jsxs("div",{className:"text-2xl font-bold text-white tabular-nums",children:["$",(s.total_trades*100).toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-graphite-deep border border-white/5 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.total_pnl>=0?"bg-aqua-pulse/10":"bg-brand-danger/10"}`,children:s.total_pnl>=0?e.jsx(he,{className:"w-4 h-4 text-aqua-pulse"}):e.jsx(Ce,{className:"w-4 h-4 text-brand-danger"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-moon-grey-dark uppercase tracking-wider",children:"Total P&L"}),e.jsxs("div",{className:`text-2xl font-bold tabular-nums ${s.total_pnl>=0?"text-aqua-pulse":"text-brand-danger"}`,children:[s.total_pnl>=0?"+":"","$",Math.abs(s.total_pnl).toLocaleString()]})]})]})})]}),e.jsx(Ts,{activeTab:d,onTabChange:N,postsCount:s.posts_count,showTradesTab:_||M}),e.jsxs("div",{className:"py-4",children:[d==="posts"&&e.jsxs(e.Fragment,{children:[M&&e.jsxs("div",{className:"mb-6 bg-graphite-deep border border-white/5 rounded-lg p-5",children:[e.jsx("textarea",{value:W,onChange:a=>be(a.target.value),placeholder:"Share your trading insights...",className:"w-full bg-graphite-light border border-white/10 rounded-lg px-4 py-3 text-white placeholder-moon-grey-dark focus:outline-none focus:ring-2 focus:ring-neon-iris/30 focus:border-neon-iris/50 focus:bg-graphite-hover resize-none transition-all text-sm leading-relaxed min-h-[100px]",rows:4,maxLength:5e3}),W.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-moon-grey-dark text-right",children:[W.length,"/5000"]}),le&&e.jsxs("div",{className:"relative mt-4 rounded-lg overflow-hidden border border-white/10 bg-graphite-light",children:[G!=null&&G.type.startsWith("image/")?e.jsx("img",{src:le,alt:"Preview",className:"w-full max-h-80 object-cover"}):e.jsx("video",{src:le,controls:!0,className:"w-full max-h-80 object-contain bg-graphite-light"}),e.jsx("button",{onClick:Ae,className:"absolute top-3 right-3 p-2 bg-graphite-deep/90 backdrop-blur-sm rounded-lg hover:bg-graphite-deep border border-white/10 transition-all",children:e.jsx(ae,{className:"w-4 h-4 text-white"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"cursor-pointer group relative",children:[e.jsx("div",{className:"p-2 rounded-lg hover:bg-graphite-light transition-all",children:e.jsx(fs,{className:"w-4 h-4 text-moon-grey group-hover:text-neon-iris transition-colors"})}),e.jsx("input",{type:"file",accept:"image/*,video/*",onChange:ve,className:"hidden"})]}),e.jsxs("label",{className:"cursor-pointer group relative",children:[e.jsx("div",{className:"p-2 rounded-lg hover:bg-graphite-light transition-all",children:e.jsx(qs,{className:"w-4 h-4 text-moon-grey group-hover:text-aqua-pulse transition-colors"})}),e.jsx("input",{type:"file",accept:"video/*",onChange:ve,className:"hidden"})]})]}),e.jsx("button",{onClick:Te,disabled:ye||!W.trim()&&!G,className:"px-5 py-2 bg-neon-iris text-white rounded-lg font-medium text-sm min-w-[100px] disabled:opacity-40 disabled:cursor-not-allowed hover:bg-neon-iris-light transition-all",children:ye?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Posting..."]}):"Post"})]})]}),j?e.jsx("div",{className:"space-y-5",children:Array.from({length:3}).map((a,i)=>e.jsx(Ys,{},i))}):r.length===0?e.jsx(xe,{icon:bs,title:"No posts yet",subtitle:M?"Share your first post":"This user hasn't posted yet"}):e.jsx("div",{className:"space-y-5",children:r.map((a,i)=>e.jsx("div",{style:{animationDelay:`${i*.05}s`},className:"animate-fade-in-up",children:e.jsx(As,{post:a,onLike:()=>Re(a.id),onToggleReplies:()=>Ee(a.id),showReplies:Q.has(a.id),onReplyCreated:()=>Ke(a.id),profile:s,onImageClick:h=>oe(h)})},a.id))})]}),d==="markets"&&e.jsx(e.Fragment,{children:I?e.jsx("div",{className:"border-t border-white/10",children:Array.from({length:5}).map((a,i)=>e.jsx("div",{className:"px-4 py-3 border-b border-white/5 animate-pulse",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-24 bg-white/10 rounded"}),e.jsx("div",{className:"h-4 w-full bg-white/10 rounded"}),e.jsx("div",{className:"h-3 w-32 bg-white/10 rounded"})]})]})},i))}):u.length===0?e.jsx("div",{className:"border-t border-white/10 py-16",children:e.jsx(xe,{icon:te,title:"No markets",subtitle:M?"Create your first prediction market":"This user hasn't created any markets"})}):e.jsx("div",{className:"border-t border-white/10",children:u.map((a,i)=>e.jsx("div",{style:{animationDelay:`${i*.05}s`},className:"animate-fade-in-up",children:e.jsx(zs,{market:a,onImageClick:h=>oe(h)})},a.id))})}),d==="trades"&&e.jsx(e.Fragment,{children:!M&&((s==null?void 0:s.required_keys_to_follow)||1)>0&&p<((s==null?void 0:s.required_keys_to_follow)||1)?e.jsx("div",{className:"border-t border-white/10 py-16",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center px-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-neon-iris/20 flex items-center justify-center mb-4",children:e.jsx(vs,{className:"w-8 h-8 text-neon-iris"})}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Keys Required"}),e.jsxs("p",{className:"text-gray-400 mb-6 max-w-md",children:["You need at least ",(s==null?void 0:s.required_keys_to_follow)||1," ","key(s) to view this trader's trades. You currently have"," ",p," key(s)."]}),f!==null&&e.jsxs("div",{className:"bg-white/5 rounded-lg p-6 w-full max-w-md border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Current Price"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",f.toFixed(4)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Supply"}),e.jsx("p",{className:"text-lg font-semibold text-white",children:s.keys_supply||0})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>k(Math.max(1,b-1)),className:"px-3 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors",children:"-"}),e.jsx("input",{type:"number",min:"1",value:b,onChange:a=>k(Math.max(1,parseInt(a.target.value)||1)),className:"flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-center focus:outline-none focus:ring-2 focus:ring-neon-iris"}),e.jsx("button",{onClick:()=>k(b+1),className:"px-3 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors",children:"+"})]}),e.jsx("button",{onClick:Fe,disabled:F||n,className:"w-full py-3 bg-neon-iris hover:bg-neon-iris/90 text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:F?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Purchasing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4"}),"Buy ",b," Key",b!==1?"s":""]})}),e.jsxs("div",{className:"mt-4 text-center space-y-1",children:[p>0&&e.jsxs("p",{className:"text-sm text-gray-400",children:["You own ",p," key",p!==1?"s":""]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(s==null?void 0:s.required_keys_to_follow)||1," key",((s==null?void 0:s.required_keys_to_follow)||1)>1?"s":""," ","required to follow"]})]})]})]})}):$?e.jsx("div",{className:"border-t border-white/10",children:Array.from({length:5}).map((a,i)=>e.jsx("div",{className:"px-4 py-3 border-b border-white/5 animate-pulse",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-24 bg-white/10 rounded"}),e.jsx("div",{className:"h-4 w-full bg-white/10 rounded"}),e.jsx("div",{className:"h-3 w-32 bg-white/10 rounded"})]})]})},i))}):C.length===0?e.jsx("div",{className:"border-t border-white/10 py-16",children:e.jsx(xe,{icon:he,title:"No trades yet",subtitle:M?"Start trading to see your activity here":"This user hasn't made any trades yet"})}):e.jsx("div",{className:"border-t border-white/10",children:C.map((a,i)=>e.jsx("div",{style:{animationDelay:`${i*.05}s`},className:"animate-fade-in-up",children:e.jsx(Us,{trade:a})},a.id))})})]})]}),e.jsx(Ps,{isOpen:fe!==null,onClose:()=>oe(null),imageUrl:fe||"",alt:"Image"}),s&&e.jsx(Ls,{isOpen:X,onClose:()=>V(!1),traderName:s.display_name||s.username||"Trader",currentSupply:s.keys_supply||1,currentPrice:f||0,keyOwnership:p,isTrader:M,onBuy:async a=>{const i=await _e({trader_id:s.id,quantity:a});if(w.success(`Successfully purchased ${i.quantity} key(s)`),await ee(),p===0&&i.quantity>=1&&!_)try{await ce(s.id),A(!0),await de()}catch(h){console.error("Auto-follow failed:",h)}},onSell:async a=>{const i=await Ge({trader_id:s.id,quantity:a});w.success(`Successfully sold ${i.quantity} key(s)`),await ee()}})]}):e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center px-4",children:[e.jsx("span",{className:"text-6xl mb-4",children:"ðŸ‘»"}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"User not found"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"This profile doesn't exist or has been removed"}),e.jsx("button",{onClick:()=>m(-1),className:"px-6 py-2.5 rounded-full bg-white/10 text-white font-medium hover:bg-white/20 transition-all",children:"Go back"})]})};export{Is as UserProfile};
