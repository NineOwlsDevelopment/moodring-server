import{r as n,aO as p,t as i,j as e,k as j,aX as b,b1 as y}from"./index-BB2XM9ES.js";const w=()=>{const[c,u]=n.useState([]),[h,o]=n.useState(!0),[x,m]=n.useState(null),[t,l]=n.useState({withdrawalId:null,status:"completed",transactionSignature:"",failureReason:""});n.useEffect(()=>{d()},[]);const d=async()=>{var s,a;try{o(!0);const r=await p();u(r.withdrawals)}catch(r){console.error("Failed to load withdrawals:",r),i.error(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to load withdrawals")}finally{o(!1)}},f=async()=>{var s,a;if(t.withdrawalId){if(t.status==="completed"&&!t.transactionSignature){i.error("Transaction signature is required for completed withdrawals");return}if(t.status==="failed"&&!t.failureReason){i.error("Failure reason is required for failed withdrawals");return}try{m(t.withdrawalId),await y(t.withdrawalId,{status:t.status,transaction_signature:t.transactionSignature||void 0,failure_reason:t.failureReason||void 0}),i.success(`Withdrawal ${t.status} successfully`),l({withdrawalId:null,status:"completed",transactionSignature:"",failureReason:""}),d()}catch(r){console.error("Failed to process withdrawal:",r),i.error(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to process withdrawal")}finally{m(null)}}};return e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Pending Withdrawals"}),e.jsx("button",{onClick:d,className:"btn btn-secondary text-sm",children:"Refresh"})]}),h?e.jsx("div",{className:"card flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-500"})}):c.length===0?e.jsx("div",{className:"card text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"No pending withdrawals"})}):e.jsx("div",{className:"card",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"User"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Amount"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Destination"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Requested"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:c.map(s=>e.jsxs("tr",{className:"border-b border-dark-700 hover:bg-dark-800 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:s.username||"Unknown"}),e.jsx("div",{className:"text-xs text-gray-400",children:s.email})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-white font-semibold",children:s.token_symbol==="USDC"?j(s.amount):`${(s.amount/1e9).toFixed(4)} SOL`})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-xs text-gray-400",children:b(s.destination_address,8)})}),e.jsx("td",{className:"py-3 px-4 text-gray-400 text-sm",children:new Date(typeof s.created_at=="string"&&s.created_at.includes(" ")?s.created_at.replace(" ","T"):s.created_at).toLocaleString()}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("button",{onClick:()=>l({withdrawalId:s.id,status:"completed",transactionSignature:"",failureReason:""}),className:"text-primary-400 hover:text-primary-300 text-sm font-medium",children:"Process"})})]},s.id))})]})})}),t.withdrawalId&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"card max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Process Withdrawal"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:t.status,onChange:s=>l(a=>({...a,status:s.target.value})),className:"input w-full",children:[e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),t.status==="completed"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Transaction Signature *"}),e.jsx("input",{type:"text",value:t.transactionSignature,onChange:s=>l(a=>({...a,transactionSignature:s.target.value})),placeholder:"Transaction signature",className:"input w-full"})]}),t.status==="failed"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Failure Reason *"}),e.jsx("textarea",{value:t.failureReason,onChange:s=>l(a=>({...a,failureReason:s.target.value})),placeholder:"Reason for failure",className:"input w-full",rows:3})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>l({withdrawalId:null,status:"completed",transactionSignature:"",failureReason:""}),className:"btn btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{onClick:f,disabled:x===t.withdrawalId,className:"btn btn-primary flex-1",children:x===t.withdrawalId?"Processing...":"Process"})]})]})})]})};export{w as AdminWithdrawals};
