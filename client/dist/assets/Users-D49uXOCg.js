import{r,b8 as I,t as o,j as e,m as c,b9 as k,b as w,A as P,ba as F,bb as L}from"./index-4FQH80kW.js";const M=1e6,R=()=>{const[h,_]=r.useState([]),[n,d]=r.useState({page:1,limit:20,total:0,totalPages:0,hasMore:!1}),[C,g]=r.useState(!0),[m,u]=r.useState(""),[b,y]=r.useState(null),[i,l]=r.useState({userId:null,amount:"",token:"USDC",reason:""}),[x,j]=r.useState(null),[S,U]=r.useState(null);r.useEffect(()=>{p()},[n.page,m]);const p=async()=>{var t,s;try{g(!0);const a=await I({page:n.page,limit:n.limit,search:m||void 0});_(a.users),d(a.pagination)}catch(a){console.error("Failed to load users:",a),o.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to load users")}finally{g(!1)}},A=t=>{t.preventDefault(),d(s=>({...s,page:1})),p()},D=async()=>{var t,s;if(!i.userId||!i.amount){o.error("Please fill in all required fields");return}try{y(i.userId);let a=Number(i.amount);i.token==="USDC"&&(a=Math.round(a*M)),await L(i.userId,{amount:a,token_symbol:i.token,reason:i.reason||"Manual adjustment"}),o.success("Balance adjusted successfully"),l({userId:null,amount:"",token:"USDC",reason:""}),p()}catch(a){console.error("Failed to adjust balance:",a),o.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to adjust balance")}finally{y(null)}},f=async(t,s)=>{var a,N;try{j(t),await F(t,!s),o.success(s?"Admin privileges removed":"User granted admin privileges"),p()}catch(v){console.error("Failed to toggle admin:",v),o.error(((N=(a=v.response)==null?void 0:a.data)==null?void 0:N.error)||"Failed to update admin status")}finally{j(null)}};return e.jsxs("div",{className:"min-h-screen bg-ink-black",children:[e.jsx("div",{className:"fixed inset-0 pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_80%_50%_at_50%_-20%,rgba(124,77,255,0.08),transparent_60%)]"})}),e.jsxs("div",{className:"relative px-4 py-6 sm:p-6 lg:p-8",children:[e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6 sm:mb-10",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] tracking-[0.3em] uppercase text-neon-iris/80 font-medium mb-2 sm:mb-3",children:"Administration"}),e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-extralight tracking-tight text-white",children:"Manage Users"})]}),e.jsxs("div",{className:"text-xs sm:text-sm text-moon-grey/50",children:[n.total.toLocaleString()," users"]})]}),e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"bg-graphite-deep/30 border border-white/5 p-4 sm:p-5 mb-4 sm:mb-6",children:e.jsxs("form",{onSubmit:A,className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by username or email...",value:m,onChange:t=>u(t.target.value),className:"flex-1 bg-ink-black border border-white/10 px-3 sm:px-4 py-2.5 sm:py-3 text-sm text-white placeholder-moon-grey/40 focus:outline-none focus:border-neon-iris/50 transition-colors"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"flex-1 sm:flex-none px-4 sm:px-6 py-2.5 sm:py-3 text-xs tracking-wide uppercase font-medium bg-white text-ink-black hover:bg-moon-grey-light transition-all duration-300",children:"Search"}),m&&e.jsx("button",{type:"button",onClick:()=>{u(""),d(t=>({...t,page:1}))},className:"px-3 sm:px-4 py-2.5 sm:py-3 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300",children:"Clear"})]})]})}),e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-graphite-deep/30 border border-white/5",children:C?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-neon-iris rounded-full animate-spin"})}):h.length===0?e.jsx("div",{className:"text-center py-20 text-moon-grey/40 text-sm",children:"No users found"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"User"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Email"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Wallet"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"USDC"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"SOL"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Created"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Role"}),e.jsx("th",{className:"text-left py-4 px-5 text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:h.map(t=>e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/[0.02] transition-colors",children:[e.jsx("td",{className:"py-4 px-5",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-light text-sm",children:t.display_name||t.username}),e.jsxs("div",{className:"text-[10px] text-moon-grey/40",children:["@",t.username]})]})}),e.jsx("td",{className:"py-4 px-5 text-moon-grey/60 text-sm font-light",children:t.email}),e.jsx("td",{className:"py-4 px-5",children:t.wallet_public_key?e.jsx("code",{className:"font-mono text-[10px] text-moon-grey/40",children:k(t.wallet_public_key,6)}):e.jsx("span",{className:"text-moon-grey/30 text-[10px]",children:"No wallet"})}),e.jsx("td",{className:"py-4 px-5 text-moon-grey/60 text-sm font-light tabular-nums",children:w(t.balance_usdc)}),e.jsxs("td",{className:"py-4 px-5 text-moon-grey/60 text-sm font-light tabular-nums",children:[(t.balance_sol/1e9).toFixed(4)," SOL"]}),e.jsx("td",{className:"py-4 px-5 text-moon-grey/40 text-sm font-light",children:new Date(typeof t.created_at=="string"&&t.created_at.includes(" ")?t.created_at.replace(" ","T"):t.created_at).toLocaleDateString()}),e.jsx("td",{className:"py-4 px-5",children:t.is_admin?e.jsx("span",{className:"px-2.5 py-1 text-[10px] tracking-[0.1em] uppercase text-neon-iris border border-neon-iris/30",children:"Admin"}):e.jsx("span",{className:"text-moon-grey/40 text-[10px] tracking-[0.1em] uppercase",children:"User"})}),e.jsx("td",{className:"py-4 px-5",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>f(t.id,t.is_admin||!1),disabled:x===t.id,className:`text-[10px] tracking-[0.1em] uppercase font-medium transition-colors disabled:opacity-50 ${t.is_admin?"text-amber-400 hover:text-amber-300":"text-neon-iris hover:text-neon-iris/80"}`,children:x===t.id?"...":t.is_admin?"Remove Admin":"Make Admin"}),e.jsx("button",{onClick:()=>l({userId:t.id,amount:"",token:"USDC",reason:""}),className:"text-[10px] tracking-[0.1em] uppercase text-neon-iris hover:text-neon-iris/80 font-medium transition-colors",children:"Adjust"})]})})]},t.id))})]})}),e.jsx("div",{className:"lg:hidden divide-y divide-white/5",children:h.map(t=>{const s=S===t.id;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between cursor-pointer",onClick:()=>U(s?null:t.id),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-light text-sm truncate",children:t.display_name||t.username}),t.is_admin&&e.jsx("span",{className:"px-1.5 py-0.5 text-[9px] tracking-[0.1em] uppercase text-neon-iris border border-neon-iris/30",children:"Admin"})]}),e.jsxs("div",{className:"text-[10px] text-moon-grey/40 mt-0.5",children:["@",t.username]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-white font-light tabular-nums",children:w(t.balance_usdc)}),e.jsx("span",{className:`text-moon-grey/40 transition-transform duration-200 inline-block ${s?"rotate-180":""}`,children:"â–¼"})]})]}),e.jsx(P,{children:s&&e.jsx(c.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"pt-4 mt-4 border-t border-white/5 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-moon-grey/40",children:"Email"}),e.jsx("div",{className:"text-white font-light truncate",children:t.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-moon-grey/40",children:"SOL"}),e.jsx("div",{className:"text-white font-light tabular-nums",children:(t.balance_sol/1e9).toFixed(4)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-moon-grey/40",children:"Wallet"}),e.jsx("div",{className:"text-moon-grey/60 font-mono text-[10px]",children:t.wallet_public_key?k(t.wallet_public_key,6):"No wallet"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-moon-grey/40",children:"Created"}),e.jsx("div",{className:"text-white font-light",children:new Date(typeof t.created_at=="string"&&t.created_at.includes(" ")?t.created_at.replace(" ","T"):t.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),f(t.id,t.is_admin||!1)},disabled:x===t.id,className:`flex-1 py-2 text-[10px] tracking-wide uppercase font-medium border transition-all disabled:opacity-50 ${t.is_admin?"text-amber-400 border-amber-400/30":"text-neon-iris border-neon-iris/30"}`,children:x===t.id?"...":t.is_admin?"Remove Admin":"Make Admin"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),l({userId:t.id,amount:"",token:"USDC",reason:""})},className:"flex-1 py-2 text-[10px] tracking-wide uppercase font-medium text-white border border-white/20",children:"Adjust Balance"})]})]})})})]},t.id)})}),n.totalPages>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 sm:px-5 py-4 border-t border-white/5",children:[e.jsxs("div",{className:"text-[10px] tracking-[0.1em] uppercase text-moon-grey/50",children:["Page ",n.page," of ",n.totalPages]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(t=>({...t,page:Math.max(1,t.page-1)})),disabled:n.page===1,className:"px-3 sm:px-4 py-2 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300 disabled:opacity-30",children:"Previous"}),e.jsx("button",{onClick:()=>d(t=>({...t,page:Math.min(t.totalPages,t.page+1)})),disabled:!n.hasMore,className:"px-3 sm:px-4 py-2 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300 disabled:opacity-30",children:"Next"})]})]})]})}),i.userId&&e.jsx("div",{className:"fixed inset-0 bg-ink-black/90 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>l({userId:null,amount:"",token:"USDC",reason:""}),children:e.jsxs(c.div,{initial:{opacity:0,y:20,scale:.98},animate:{opacity:1,y:0,scale:1},onClick:t=>t.stopPropagation(),className:"relative bg-graphite-deep border border-white/5 max-w-md w-full p-5 sm:p-6",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-neon-iris/50 to-transparent"}),e.jsx("h2",{className:"text-lg sm:text-xl font-light text-white mb-5 sm:mb-6",children:"Adjust User Balance"}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-2 sm:mb-3",children:"Token"}),e.jsxs("select",{value:i.token,onChange:t=>l(s=>({...s,token:t.target.value})),className:"w-full bg-ink-black border border-white/10 px-3 sm:px-4 py-2.5 sm:py-3 text-sm text-white focus:outline-none focus:border-neon-iris/50 transition-colors",children:[e.jsx("option",{value:"USDC",children:"USDC"}),e.jsx("option",{value:"SOL",children:"SOL"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-2 sm:mb-3",children:"Amount (negative for deduction)"}),e.jsx("input",{type:"number",step:i.token==="USDC"?"0.01":"0.000001",value:i.amount,onChange:t=>l(s=>({...s,amount:t.target.value})),placeholder:i.token==="USDC"?"Amount in USDC":"Amount in SOL",className:"w-full bg-ink-black border border-white/10 px-3 sm:px-4 py-2.5 sm:py-3 text-sm text-white placeholder-moon-grey/40 focus:outline-none focus:border-neon-iris/50 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] tracking-[0.15em] uppercase text-moon-grey/50 mb-2 sm:mb-3",children:"Reason (optional)"}),e.jsx("input",{type:"text",value:i.reason,onChange:t=>l(s=>({...s,reason:t.target.value})),placeholder:"Reason for adjustment",className:"w-full bg-ink-black border border-white/10 px-3 sm:px-4 py-2.5 sm:py-3 text-sm text-white placeholder-moon-grey/40 focus:outline-none focus:border-neon-iris/50 transition-colors"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-5 sm:mt-6",children:[e.jsx("button",{onClick:()=>l({userId:null,amount:"",token:"USDC",reason:""}),className:"flex-1 py-2.5 sm:py-3 text-xs tracking-wide uppercase font-medium text-white border border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-300",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:b===i.userId,className:"flex-1 py-2.5 sm:py-3 text-xs tracking-wide uppercase font-medium bg-white text-ink-black hover:bg-moon-grey-light transition-all duration-300 disabled:opacity-50",children:b===i.userId?"Processing...":"Adjust"})]})]})})]})]})};export{R as AdminUsers};
