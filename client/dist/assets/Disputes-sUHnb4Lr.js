import{r,bg as _,t as c,j as e,L as k,b7 as v,bh as R}from"./index-CyUWOdn5.js";const D=()=>{const[x,j]=r.useState([]),[n,m]=r.useState({total:0,page:1,limit:50,offset:0,has_more:!1}),[y,u]=r.useState(!0),[h,p]=r.useState(null),[d,b]=r.useState("all"),[t,i]=r.useState({disputeId:null,status:"resolved",reviewNotes:""});r.useEffect(()=>{o()},[d]);const o=async()=>{var s,a;try{u(!0);const l=await _({page:n.page,limit:n.limit,status:d!=="all"?d:void 0});j(l.disputes),m(l.pagination)}catch(l){console.error("Failed to load disputes:",l),c.error(((a=(s=l.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to load disputes")}finally{u(!1)}},f=async()=>{var s,a;if(t.disputeId)try{p(t.disputeId),await R(t.disputeId,{status:t.status,review_notes:t.reviewNotes||void 0}),c.success("Dispute resolved successfully"),i({disputeId:null,status:"resolved",reviewNotes:""}),o()}catch(l){console.error("Failed to resolve dispute:",l),c.error(((a=(s=l.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to resolve dispute")}finally{p(null)}},N=s=>{switch(s){case"resolved":return"text-green-400 bg-green-500/20 border-green-500/30";case"dismissed":return"text-gray-400 bg-gray-500/20 border-gray-500/30";case"reviewed":return"text-blue-400 bg-blue-500/20 border-blue-500/30";default:return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30"}},g=s=>new Date(s*1e3).toLocaleString(),w=s=>(s/1e6).toFixed(2);return e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Disputes"}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Total: ",n.total," disputes"]})]}),e.jsx("div",{className:"card mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Filter by Status:"}),e.jsxs("select",{value:d,onChange:s=>b(s.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"reviewed",children:"Reviewed"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"dismissed",children:"Dismissed"})]})]})}),y?e.jsx("div",{className:"card flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-500"})}):x.length===0?e.jsx("div",{className:"card text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"No disputes found"})}):e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Market"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Option"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"User"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Reason"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Fee Paid"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Created"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:x.map(s=>e.jsxs("tr",{className:"border-b border-dark-700 hover:bg-dark-800 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx(k,{to:`/market/${s.market_id}`,className:"text-primary-400 hover:text-primary-300 text-sm font-medium",children:s.market_question||v(s.market_id,8)})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-gray-300 text-sm",children:s.option_label||"N/A"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-gray-300 text-sm",children:s.user_display_name||s.user_username||v(s.user_id,8)})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-gray-400 text-sm line-clamp-1 max-w-xs",children:s.reason})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"text-gray-300 text-sm",children:["$",w(s.resolution_fee_paid)," USDC"]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${N(s.status)}`,children:s.status})}),e.jsx("td",{className:"py-3 px-4 text-gray-400 text-sm",children:g(s.created_at)}),e.jsx("td",{className:"py-3 px-4",children:s.status==="pending"?e.jsx("button",{onClick:()=>i({disputeId:s.id,status:"resolved",reviewNotes:""}),className:"text-primary-400 hover:text-primary-300 text-sm font-medium",children:"Resolve"}):e.jsx("span",{className:"text-gray-500 text-sm",children:s.reviewer_username||s.reviewer_display_name?`Reviewed by ${s.reviewer_display_name||s.reviewer_username}`:"N/A"})})]},s.id))})]})}),n.has_more&&e.jsx("div",{className:"flex justify-center mt-6 pt-6 border-t border-dark-700",children:e.jsx("button",{onClick:()=>{m(s=>({...s,page:s.page+1,offset:s.offset+s.limit})),o()},className:"btn btn-secondary",children:"Load More"})})]}),t.disputeId&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"card max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Resolve Dispute"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Resolution Status"}),e.jsxs("select",{value:t.status,onChange:s=>i(a=>({...a,status:s.target.value})),className:"input w-full",children:[e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"dismissed",children:"Dismissed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Review Notes"}),e.jsx("textarea",{value:t.reviewNotes,onChange:s=>i(a=>({...a,reviewNotes:s.target.value})),placeholder:"Add review notes (optional)...",className:"input w-full",rows:4})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>i({disputeId:null,status:"resolved",reviewNotes:""}),className:"btn btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{onClick:f,disabled:h===t.disputeId,className:"btn btn-primary flex-1",children:h===t.disputeId?"Resolving...":"Submit Resolution"})]})]})})]})};export{D as AdminDisputes};
