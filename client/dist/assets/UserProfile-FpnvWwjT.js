import{c as y,W as pe,d as ge,a4 as X,r as c,b as ue,t as g,aD as be,aE as we,aF as fe,aG as je,j as e,L as O,aH as Ne,ai as B,V as ee,X as se,aI as ye,aJ as ve,aK as ke,w as K,aL as _e,aM as Ce,aN as Se,aO as $e,aP as Pe}from"./index-laL039p8.js";import{A as Fe}from"./arrow-left-BzHVzYfR.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],Me=y("arrow-down-right",Le);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],qe=y("arrow-up-right",Re);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Ae=y("award",Te);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],ze=y("circle-plus",Ee);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],De=y("ellipsis-vertical",Ue);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],He=y("external-link",Ve);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],We=y("file-text",Ie);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],te=y("heart",Ye);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ke=y("image",Be);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Q=y("message-circle",Ge);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Oe=y("share-2",Je);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Qe=y("trending-down",Xe);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],es=y("video",Ze),ss=({name:s,imageUrl:o,size:d="xl"})=>{const t={lg:"w-20 h-20 text-2xl",xl:"w-24 h-24 text-3xl","2xl":"w-32 h-32 text-4xl"},p=["bg-neon-iris/20 text-neon-iris border-neon-iris/30","bg-aqua-pulse/20 text-aqua-pulse border-aqua-pulse/30","bg-graphite-light text-moon-grey border-white/10","bg-white/10 text-white border-white/20"],l=s.charCodeAt(0)%p.length;return o?e.jsx("img",{src:o,alt:s,className:`${t[d]} rounded-full object-cover border-2 border-white/10`}):e.jsx("div",{className:`${t[d]} rounded-full ${p[l]} border-2 flex items-center justify-center font-semibold`,children:s.charAt(0).toUpperCase()})},ae=({name:s,size:o="md",imageUrl:d})=>{const t={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base"},p=["bg-neon-iris/20 text-neon-iris border-neon-iris/30","bg-aqua-pulse/20 text-aqua-pulse border-aqua-pulse/30","bg-graphite-light text-moon-grey border-white/10"],l=s.charCodeAt(0)%p.length;return e.jsx("div",{className:"relative flex-shrink-0",children:d?e.jsx("img",{src:d,alt:s,className:`${t[o]} rounded-full object-cover border border-white/10`}):e.jsx("div",{className:`${t[o]} rounded-full ${p[l]} border flex items-center justify-center font-semibold`,children:s.charAt(0).toUpperCase()})})},ts=({isLiked:s,likesCount:o,commentsCount:d,onLike:t,onComment:p,onShare:l})=>e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsxs("button",{onClick:t,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl transition-all duration-300 min-h-[44px] group ${s?"bg-brand-danger/15 text-brand-danger hover:bg-brand-danger/20":"hover:bg-white/5 text-moon-grey hover:text-brand-danger"}`,children:[e.jsx(te,{className:`w-5 h-5 transition-all duration-300 ${s?"scale-110 fill-current":"group-hover:scale-110"}`}),e.jsx("span",{className:"text-sm font-semibold tabular-nums",children:o})]}),e.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2.5 rounded-xl hover:bg-white/5 text-moon-grey hover:text-neon-iris transition-all min-h-[44px] group",children:[e.jsx(Q,{className:"w-5 h-5 group-hover:scale-110 transition-transform duration-300"}),e.jsx("span",{className:"text-sm font-semibold tabular-nums",children:d})]})]}),e.jsx("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2.5 rounded-xl hover:bg-white/5 text-moon-grey hover:text-aqua-pulse transition-all min-h-[44px] group",children:e.jsx(Oe,{className:"w-5 h-5 group-hover:scale-110 transition-transform duration-300"})})]}),as=({postId:s,isOpen:o,onReplyCreated:d})=>{const[t,p]=c.useState([]),[l,j]=c.useState(new Map),[k,_]=c.useState(new Set),[C,M]=c.useState(new Set),[v,H]=c.useState(!1),[P,F]=c.useState(""),[E,z]=c.useState(!1),[f,R]=c.useState(null),I=c.useRef(null);c.useEffect(()=>{o&&U()},[o,s]);const U=async()=>{H(!0);try{const{comments:n}=await Ce(s,{limit:50});p(n)}catch(n){console.error("Failed to load comments:",n)}finally{H(!1)}},S=async n=>{if(!(l.has(n)||C.has(n))){M(r=>new Set(r).add(n));try{const{replies:r}=await $e(n,{limit:50});j(x=>{const h=new Map(x);return h.set(n,r),h})}catch(r){console.error("Failed to load replies:",r)}finally{M(r=>{const x=new Set(r);return x.delete(n),x})}}},D=n=>{k.has(n)?_(r=>{const x=new Set(r);return x.delete(n),x}):(_(r=>new Set(r).add(n)),S(n))},q=async()=>{var n,r;if(!(!P.trim()||E)){z(!0);try{await Se({post_id:s,content:P.trim(),parent_comment_id:(f==null?void 0:f.id)||void 0}),F(""),R(null),U(),f!=null&&f.id&&(j(x=>{const h=new Map(x);return h.delete(f.id),h}),S(f.id)),d(),g.success("Reply posted!")}catch(x){g.error(((r=(n=x.response)==null?void 0:n.data)==null?void 0:r.error)||"Failed to post reply")}finally{z(!1)}}},W=(n,r,x)=>{var u;const h=r||x;R({id:n,name:h}),F(`@${h} `),(u=I.current)==null||u.focus()},Y=async n=>{var r,x;try{const h=await Pe(n);p(u=>u.map(N=>N.id===n?{...N,is_liked:h.liked,likes_count:h.likes_count}:N)),j(u=>{const N=new Map(u);for(const[L,b]of N.entries()){const T=b.map(A=>A.id===n?{...A,is_liked:h.liked,likes_count:h.likes_count}:A);N.set(L,T)}return N})}catch(h){g.error(((x=(r=h.response)==null?void 0:r.data)==null?void 0:x.error)||"Failed to like comment")}},V=(n,r,x=[])=>{for(const h of n){x.push({comment:h,parent:r,depth:r?1:0});const u=l.get(h.id);u&&k.has(h.id)&&V(u,h,x)}return x},$=n=>{const{comment:r,parent:x,depth:h}=n,u=l.get(r.id),N=l.has(r.id),L=u&&u.length>0,b=k.has(r.id),T=!!x;return e.jsxs("div",{className:`relative pr-3 py-3 hover:bg-graphite-light transition-colors border-b border-white/5 last:border-b-0 ${T?"pl-12 ml-8":"pl-3"}`,children:[T&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-px bg-white/10"}),e.jsx("div",{className:"absolute left-0 top-[18px] w-8 h-px bg-white/10"})]}),e.jsxs("div",{className:"flex gap-3 relative",children:[e.jsx("div",{className:"flex-shrink-0 relative",children:e.jsx(ae,{name:r.display_name||r.username,size:"sm",imageUrl:r.avatar_url||void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[x&&e.jsx("div",{className:"mb-1.5",children:e.jsxs("span",{className:"text-xs text-moon-grey-dark",children:["Replying to"," ",e.jsx("span",{className:"font-medium text-moon-grey",children:x.display_name||x.username})]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-semibold text-sm text-white",children:r.display_name||r.username}),h===0&&e.jsxs("span",{className:"text-xs text-moon-grey-dark",children:["@",r.username]}),e.jsx("span",{className:"text-xs text-moon-grey-dark",children:r.created_at?K(Number(r.created_at)):"now"})]}),e.jsx("p",{className:"text-sm text-moon-grey-light mt-1 whitespace-pre-wrap leading-relaxed",children:r.content}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("button",{onClick:()=>Y(r.id),className:`flex items-center gap-1.5 text-xs transition-colors font-medium ${r.is_liked?"text-brand-danger hover:text-brand-danger/80":"text-moon-grey-dark hover:text-brand-danger"}`,children:[e.jsx(te,{className:`w-3.5 h-3.5 ${r.is_liked?"fill-current":""}`}),r.likes_count!==void 0&&r.likes_count>0?r.likes_count:""]}),e.jsx("button",{onClick:()=>W(r.id,r.display_name,r.username),className:"text-xs text-moon-grey-dark hover:text-neon-iris transition-colors font-medium",children:"Reply"}),e.jsx("button",{onClick:()=>D(r.id),className:"text-xs text-moon-grey-dark hover:text-neon-iris transition-colors font-medium",children:b?"Hide replies":N&&L?`${u.length} ${u.length===1?"reply":"replies"}`:N&&!L?"No replies":"View replies"})]})]})]})]},r.id)};return o?e.jsxs("div",{className:"border-t border-white/5 bg-graphite-deep",children:[e.jsxs("div",{className:"p-5 border-b border-white/5",children:[f&&e.jsxs("div",{className:"mb-3 px-3 py-2 bg-graphite-light border border-white/10 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"text-moon-grey-dark",children:"Replying to"}),e.jsx("span",{className:"text-neon-iris font-semibold",children:f.name})]}),e.jsx("button",{onClick:()=>{R(null),F("")},className:"p-1 rounded-lg hover:bg-graphite-hover text-moon-grey hover:text-white transition-all",children:e.jsx(se,{className:"w-3.5 h-3.5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{ref:I,value:P,onChange:n=>F(n.target.value),onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),q())},placeholder:f?`Reply to ${f.name}...`:"Write a reply...",rows:P.split(`
`).length+1,className:"w-full bg-graphite-light border border-white/10 rounded-lg px-4 py-3 text-sm text-white placeholder-moon-grey-dark focus:outline-none focus:ring-2 focus:ring-neon-iris/30 focus:border-neon-iris/50 focus:bg-graphite-hover transition-all resize-none min-h-[44px] max-h-32 leading-relaxed"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Press Enter to reply, Shift+Enter for new line"}),e.jsx("button",{onClick:q,disabled:!P.trim()||E,className:"px-5 py-2 rounded-lg bg-neon-iris text-white text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-neon-iris-light transition-all flex items-center gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-3.5 h-3.5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Posting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"Reply"})]})})]})]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:v?e.jsx("div",{className:"p-5 text-center text-moon-grey-dark text-sm",children:"Loading comments..."}):t.length===0?e.jsx("div",{className:"p-5 text-center text-moon-grey-dark text-sm",children:"No replies yet"}):e.jsx("div",{children:V(t).map(n=>e.jsx("div",{children:$(n)},n.comment.id))})})]}):null},rs=({post:s,onLike:o,onToggleReplies:d,showReplies:t,onReplyCreated:p,profile:l})=>{const j=async()=>{try{await navigator.clipboard.writeText(window.location.origin+`/post/${s.id}`),g.success("Link copied!")}catch{g.error("Failed to copy link")}};return e.jsxs("article",{className:"bg-graphite-deep border border-white/5 rounded-lg transition-all duration-200 hover:border-white/10",children:[e.jsx("div",{className:"p-5 pb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ae,{name:l.display_name||l.username,size:"md",imageUrl:l.avatar_url||void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-semibold text-white text-[15px]",children:l.display_name||l.username}),l.total_pnl>1e4&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold bg-neon-iris/20 text-neon-iris border border-neon-iris/30 rounded",children:"VIP"}),e.jsx("span",{className:"text-gray-500",children:"Â·"}),e.jsx("span",{className:"text-xs text-gray-500",children:s.created_at?K(Number(s.created_at)):"now"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["@",l.username]})]}),e.jsx("button",{className:"p-2 rounded-xl hover:bg-white/5 text-moon-grey-dark hover:text-white transition-all min-w-[40px] min-h-[40px] flex items-center justify-center",children:e.jsx(De,{className:"w-5 h-5"})})]})}),s.market_question&&e.jsxs(O,{to:`/market/${s.market_id}`,className:"mx-5 mb-4 flex items-center gap-2.5 px-3 py-2 bg-graphite-light border border-white/10 rounded-lg transition-all group hover:border-neon-iris/30",children:[e.jsx(B,{className:"w-4 h-4 text-neon-iris flex-shrink-0"}),e.jsx("span",{className:"text-sm text-moon-grey-light group-hover:text-white line-clamp-1 font-medium flex-1",children:s.market_question}),e.jsx("svg",{className:"w-4 h-4 text-moon-grey ml-auto flex-shrink-0 group-hover:text-neon-iris group-hover:translate-x-0.5 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),e.jsx("div",{className:"px-5 pb-4 relative",children:e.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap text-sm",children:s.content})}),s.image_url&&e.jsx("div",{className:"relative mx-5 mb-4 rounded-lg overflow-hidden border border-white/10",children:e.jsx("img",{src:s.image_url,alt:"Post attachment",loading:"lazy",className:"w-full max-h-[500px] object-cover max-w-full"})}),s.video_url&&e.jsx("div",{className:"relative mx-5 mb-4 rounded-lg overflow-hidden border border-white/10 bg-graphite-light",onClick:k=>k.stopPropagation(),children:e.jsx("video",{src:s.video_url,controls:!0,className:"w-full max-h-[500px] object-contain max-w-full",preload:"metadata",children:"Your browser does not support the video tag."})}),e.jsx("div",{className:"px-5 pb-4",children:e.jsx(ts,{isLiked:s.is_liked||!1,likesCount:s.likes_count,commentsCount:s.comments_count,onLike:o,onComment:d,onShare:j})}),e.jsxs("button",{onClick:d,className:"w-full px-5 py-3 bg-graphite-light border-t border-white/5 text-sm text-moon-grey hover:text-white hover:bg-graphite-hover transition-all flex items-center gap-2 font-medium",children:[e.jsx(Q,{className:"w-4 h-4 text-neon-iris"}),t?"Hide replies":s.comments_count>0?`View ${s.comments_count} ${s.comments_count===1?"reply":"replies"}`:"Reply"]}),e.jsx(as,{postId:s.id,isOpen:t,onReplyCreated:p})]})},is=({activeTab:s,onTabChange:o,postsCount:d,showTradesTab:t})=>{const p=[{id:"posts",label:"Posts",count:d},{id:"markets",label:"Markets"},...t?[{id:"trades",label:"Trades"}]:[]];return e.jsx("div",{className:"flex border-b border-white/10 gap-1",children:p.map(l=>e.jsxs("button",{onClick:()=>o(l.id),className:`px-4 py-3 text-sm font-medium transition-all relative ${s===l.id?"text-white":"text-moon-grey hover:text-white"}`,children:[l.label,l.count!==void 0&&e.jsxs("span",{className:"ml-1.5 text-xs text-moon-grey-dark",children:["(",l.count,")"]}),s===l.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-neon-iris"})]},l.id))})},J=({icon:s,title:o,subtitle:d})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-graphite-deep border border-white/10 flex items-center justify-center mb-4",children:e.jsx(s,{className:"w-8 h-8 text-moon-grey"})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:o}),e.jsx("p",{className:"text-moon-grey-dark text-sm text-center",children:d})]}),ns=()=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-32 bg-graphite-deep border-b border-white/5"}),e.jsxs("div",{className:"px-4 -mt-12",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-graphite-light mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-6 w-40 bg-graphite-light rounded"}),e.jsx("div",{className:"h-4 w-24 bg-graphite-light rounded"}),e.jsx("div",{className:"h-4 w-full bg-graphite-light rounded"})]})]})]}),ls=()=>e.jsxs("div",{className:"bg-graphite-deep border border-white/5 rounded-lg animate-pulse",children:[e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-3 w-32 bg-graphite-light rounded"}),e.jsx("div",{className:"h-4 w-full bg-graphite-light rounded"}),e.jsx("div",{className:"h-4 w-3/4 bg-graphite-light rounded"})]}),e.jsx("div",{className:"h-48 bg-graphite-light"})]}),os=({market:s})=>{const o=X();let d=[];if(s.is_binary&&s.options&&s.options.length>0){const t=s.options[0],p=t.yes_price??.5,l=t.no_price??1-p;d=[{option:t,side:"yes",price:p},{option:t,side:"no",price:l}]}else s.options&&s.options.length>0&&(d=s.options.slice(0,2).map(t=>({option:t,side:"other",price:t.yes_price??.5})));return e.jsx("article",{className:"px-4 py-3 hover:bg-white/[0.02] transition-colors cursor-pointer border-b border-white/5",onClick:()=>o(`/market/${s.id}`),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-graphite-light border border-white/10 flex items-center justify-center",children:e.jsx(ze,{className:"w-5 h-5 text-neon-iris"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"text-[15px] font-semibold text-white",children:"Created market"}),e.jsx("span",{className:"text-gray-500",children:"Â·"}),e.jsx("span",{className:"text-[15px] text-gray-500",children:s.created_at?K(Number(s.created_at)):"now"})]}),e.jsx("p",{className:"text-[15px] text-white leading-5 mb-3",children:s.question}),e.jsxs("div",{className:"flex gap-3 mb-2",children:[s.image_url&&e.jsx("div",{className:"flex-shrink-0 w-24 h-24 rounded-xl overflow-hidden",children:e.jsx("img",{src:s.image_url,alt:"",className:"w-full h-full object-cover",loading:"lazy"})}),d.length>0&&e.jsxs("div",{className:"flex-1 flex flex-col gap-1.5 min-w-0",children:[d.map((t,p)=>{const{option:l,side:j,price:k}=t,_=j==="yes",C=j==="no",M=_?"Yes":C?"No":l.option_label;return e.jsxs("div",{className:`flex items-center gap-2 px-2 py-1.5 rounded-lg hover:bg-graphite-light transition-colors border ${_?"bg-aqua-pulse/10 border-aqua-pulse/20":C?"bg-brand-danger/10 border-brand-danger/20":"bg-graphite-light border-white/10"}`,onClick:v=>{v.stopPropagation(),o(`/market/${s.id}`)},children:[l.option_image_url?e.jsx("img",{src:l.option_image_url,alt:"",className:"w-4 h-4 rounded object-cover flex-shrink-0"}):e.jsx("div",{className:`w-4 h-4 rounded flex-shrink-0 ${_?"bg-emerald-500/20":C?"bg-rose-500/20":"bg-white/10"}`}),e.jsx("span",{className:`text-[13px] flex-1 truncate font-medium ${_?"text-aqua-pulse":C?"text-brand-danger":"text-white"}`,children:M}),e.jsxs("span",{className:"text-[13px] text-moon-grey-dark flex-shrink-0",children:[(k*100).toFixed(0),"Â¢"]})]},`${l.id}-${j}-${p}`)}),!s.is_binary&&s.options&&s.options.length>2&&e.jsx("div",{className:"px-2 py-1",children:e.jsxs("span",{className:"text-[13px] text-gray-500",children:["+",s.options.length-2," more"]})})]})]})]})]})})},ds=({trade:s})=>{const o=X(),d=s.action==="buy",t=s.side==="yes";return e.jsx("article",{className:"relative px-4 py-3 hover:bg-white/[0.02] transition-colors cursor-pointer border-b border-white/5",onClick:()=>s.market_id&&o(`/market/${s.market_id}`),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d?"bg-aqua-pulse/20 text-aqua-pulse":"bg-brand-danger/20 text-brand-danger"}`,children:d?e.jsx(qe,{className:"w-5 h-5"}):e.jsx(Me,{className:"w-5 h-5"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:`text-sm font-semibold ${d?"text-aqua-pulse":"text-brand-danger"}`,children:d?"Bought":"Sold"}),e.jsx("span",{className:"text-gray-500",children:"Â·"}),e.jsx("span",{className:"text-xs text-gray-500",children:s.created_at?K(Number(s.created_at)):"now"})]}),s.market_question&&e.jsx("p",{className:"text-white text-sm mb-2 line-clamp-2 leading-relaxed",children:s.market_question}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${t?"bg-emerald-500/20 text-emerald-400":"bg-rose-500/20 text-rose-400"}`,children:s.option_label||(t?"Yes":"No")}),e.jsxs("span",{className:"text-sm text-gray-400",children:[(s.shares/1e6).toFixed(2)," shares"]}),s.pricePerShare!==void 0&&e.jsxs("span",{className:"text-sm text-gray-400",children:["@ $",(s.pricePerShare*100).toFixed(2)]}),s.amount&&e.jsxs("span",{className:`text-sm font-semibold ml-auto ${d?"text-aqua-pulse":"text-brand-danger"}`,children:[d?"+":"-","$",(Math.abs(s.amount)/1e6).toFixed(2)]})]}),s.market_id&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-gray-500 hover:text-neon-iris transition-colors",children:[e.jsx("span",{children:"View market"}),e.jsx(He,{className:"w-3 h-3"})]})]})]})})},hs=()=>{const{identifier:s}=pe(),{user:o}=ge(),d=X(),[t,p]=c.useState(null),[l,j]=c.useState([]),[k,_]=c.useState([]),[C,M]=c.useState([]),[v,H]=c.useState("posts"),[P,F]=c.useState(!0),[E,z]=c.useState(!0),[f,R]=c.useState(!1),[I,U]=c.useState(!1),[S,D]=c.useState(!1),[q,W]=c.useState(!1),[Y,V]=c.useState(new Set),[$,n]=c.useState(""),[r,x]=c.useState(null),[h,u]=c.useState(null),[N,L]=c.useState(!1),b=(o==null?void 0:o.id)===s||(o==null?void 0:o.username)===s;c.useEffect(()=>{s&&(T(),ne())},[s]),c.useEffect(()=>{t!=null&&t.id&&A()},[t==null?void 0:t.id]),c.useEffect(()=>{s&&v==="trades"&&(S||b)&&re()},[s,v,S,b]),c.useEffect(()=>{s&&v==="markets"&&(t!=null&&t.id)&&ie()},[s,v,t==null?void 0:t.id]);const T=async()=>{if(s){F(!0);try{const a=await ue.get(`/user/profile/${s}`);p(a.data.user)}catch(a){console.error("Failed to load profile:",a),g.error("Failed to load profile")}finally{F(!1)}}},A=async()=>{if(t!=null&&t.id){z(!0);try{const{posts:a}=await be(t.id);j(a)}catch(a){console.error("Failed to load posts:",a)}finally{z(!1)}}},re=async()=>{var a;if(s){R(!0);try{const i=(t==null?void 0:t.id)||s,{trades:m}=await we(i,{page:1,limit:50});_(m)}catch(i){console.error("Failed to load trades:",i),((a=i.response)==null?void 0:a.status)===403?g.error("You must follow this user to view their trades"):g.error("Failed to load trades")}finally{R(!1)}}},ie=async()=>{if(t!=null&&t.id){U(!0);try{const{markets:a}=await fe({creator:t.id,page:1,limit:50});M(a)}catch(a){console.error("Failed to load markets:",a),g.error("Failed to load markets")}finally{U(!1)}}},ne=async()=>{if(!(!s||!o||b))try{const a=(t==null?void 0:t.id)||s,{is_following:i}=await je(a);D(i)}catch(a){console.error("Failed to check follow status:",a)}},le=async()=>{var a,i;if(!(!s||q)){W(!0);try{const m=(t==null?void 0:t.id)||s;S?(await ye(m),D(!1),p(w=>w?{...w,followers_count:w.followers_count-1}:null),g.success("Unfollowed")):(await ve(m),D(!0),p(w=>w?{...w,followers_count:w.followers_count+1}:null),g.success("Following! ðŸŽ‰"))}catch(m){g.error(((i=(a=m.response)==null?void 0:a.data)==null?void 0:i.error)||"Action failed")}finally{W(!1)}}},oe=async a=>{var i,m;try{const w=await _e(a);j(me=>me.map(G=>G.id===a?{...G,is_liked:w.liked,likes_count:w.likes_count}:G))}catch(w){g.error(((m=(i=w.response)==null?void 0:i.data)==null?void 0:m.error)||"Failed to like post")}},de=a=>{Y.has(a)?V(i=>{const m=new Set(i);return m.delete(a),m}):V(i=>new Set(i).add(a))},ce=a=>{j(i=>i.map(m=>m.id===a?{...m,comments_count:m.comments_count+1}:m))},Z=a=>{var w;const i=(w=a.target.files)==null?void 0:w[0];if(!i)return;if(!i.type.startsWith("image/")&&!i.type.startsWith("video/")){g.error("Please select an image or video file");return}if(i.size>100*1024*1024){g.error("File size must be less than 100MB");return}x(i);const m=new FileReader;m.onloadend=()=>{u(m.result)},m.readAsDataURL(i)},xe=()=>{x(null),u(null)},he=async()=>{var a,i;if(!$.trim()&&!r){g.error("Please add some content or media");return}if(!o){g.error("Please log in to create a post");return}L(!0);try{await ke({content:$.trim()||"",media:r||void 0}),n(""),x(null),u(null),await A(),g.success("Post created!")}catch(m){console.error("Failed to create post:",m),g.error(((i=(a=m.response)==null?void 0:a.data)==null?void 0:i.error)||"Failed to create post")}finally{L(!1)}};return P?e.jsx("div",{className:"min-h-screen pb-20",children:e.jsx(ns,{})}):t?e.jsxs("div",{className:"min-h-screen pb-20 md:pb-8 bg-ink-black",children:[e.jsxs("div",{className:"h-32 md:h-40 bg-graphite-deep border-b border-white/5 relative",children:[e.jsx("button",{onClick:()=>d(-1),className:"absolute top-4 left-4 p-2 rounded-lg bg-graphite-deep/80 backdrop-blur-sm text-moon-grey hover:text-white hover:bg-graphite-light border border-white/10 transition-all min-w-[40px] min-h-[40px] flex items-center justify-center",children:e.jsx(Fe,{className:"w-5 h-5"})}),b&&e.jsx(O,{to:"/settings",className:"absolute top-4 right-4 p-2 rounded-lg bg-graphite-deep/80 backdrop-blur-sm text-moon-grey hover:text-white hover:bg-graphite-light border border-white/10 transition-all min-w-[40px] min-h-[40px] flex items-center justify-center",children:e.jsx(Ne,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative max-w-4xl mx-auto px-4 sm:px-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 -mt-12 mb-8",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ss,{name:t.display_name||t.username,imageUrl:t.avatar_url,size:"xl"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white break-words",children:t.display_name||t.username}),t.total_trades>100&&e.jsx("span",{title:"Verified trader",className:"flex-shrink-0",children:e.jsx(Ae,{className:"w-5 h-5 text-neon-iris"})})]}),e.jsxs("p",{className:"text-moon-grey text-sm mb-1",children:["@",t.username]}),t.created_at&&e.jsxs("p",{className:"text-moon-grey text-sm mb-3",children:["Joined"," ",(()=>{const a=Number(t.created_at),i=new Date(a>1e11?a:a*1e3);return isNaN(i.getTime())?"recently":i.toLocaleDateString("en-US",{month:"long",year:"numeric"})})()]}),t.bio&&e.jsx("p",{className:"text-moon-grey-light text-sm leading-relaxed mb-4 break-words",children:t.bio}),e.jsxs("div",{className:"flex items-center gap-6 text-sm mb-3",children:[e.jsxs("button",{className:"hover:text-white transition-colors",children:[e.jsx("span",{className:"font-semibold text-white tabular-nums",children:t.following_count}),e.jsx("span",{className:"text-moon-grey ml-1.5",children:"Following"})]}),e.jsxs("button",{className:"hover:text-white transition-colors",children:[e.jsx("span",{className:"font-semibold text-white tabular-nums",children:t.followers_count}),e.jsx("span",{className:"text-moon-grey ml-1.5",children:"Followers"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[!b&&o&&e.jsx("button",{onClick:le,disabled:q,className:`px-4 py-2 rounded-lg font-medium text-sm transition-all border ${S?"bg-graphite-deep text-white border-white/10 hover:bg-graphite-light":"bg-neon-iris text-white border-neon-iris hover:bg-neon-iris-light"}`,children:q?"...":S?"Following":"Follow"}),b&&e.jsx(O,{to:"/settings",className:"px-4 py-2 rounded-lg bg-graphite-deep text-white font-medium text-sm hover:bg-graphite-light border border-white/10 transition-all",children:"Edit Profile"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8",children:[e.jsx("div",{className:"bg-graphite-deep border border-white/5 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-neon-iris/10",children:e.jsx(B,{className:"w-4 h-4 text-neon-iris"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-moon-grey-dark uppercase tracking-wider",children:"Total Trades"}),e.jsx("div",{className:"text-2xl font-bold text-white tabular-nums",children:t.total_trades})]})]})}),e.jsx("div",{className:"bg-graphite-deep border border-white/5 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-aqua-pulse/10",children:e.jsx(B,{className:"w-4 h-4 text-aqua-pulse"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-moon-grey-dark uppercase tracking-wider",children:"Total Volume"}),e.jsxs("div",{className:"text-2xl font-bold text-white tabular-nums",children:["$",(t.total_trades*100).toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-graphite-deep border border-white/5 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`p-2 rounded-lg ${t.total_pnl>=0?"bg-aqua-pulse/10":"bg-brand-danger/10"}`,children:t.total_pnl>=0?e.jsx(ee,{className:"w-4 h-4 text-aqua-pulse"}):e.jsx(Qe,{className:"w-4 h-4 text-brand-danger"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-moon-grey-dark uppercase tracking-wider",children:"Total P&L"}),e.jsxs("div",{className:`text-2xl font-bold tabular-nums ${t.total_pnl>=0?"text-aqua-pulse":"text-brand-danger"}`,children:[t.total_pnl>=0?"+":"","$",Math.abs(t.total_pnl).toLocaleString()]})]})]})})]}),e.jsx(is,{activeTab:v,onTabChange:H,postsCount:t.posts_count,showTradesTab:S||b}),e.jsxs("div",{className:"py-4",children:[v==="posts"&&e.jsxs(e.Fragment,{children:[b&&e.jsxs("div",{className:"mb-6 bg-graphite-deep border border-white/5 rounded-lg p-5",children:[e.jsx("textarea",{value:$,onChange:a=>n(a.target.value),placeholder:"Share your trading insights...",className:"w-full bg-graphite-light border border-white/10 rounded-lg px-4 py-3 text-white placeholder-moon-grey-dark focus:outline-none focus:ring-2 focus:ring-neon-iris/30 focus:border-neon-iris/50 focus:bg-graphite-hover resize-none transition-all text-sm leading-relaxed min-h-[100px]",rows:4,maxLength:5e3}),$.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-moon-grey-dark text-right",children:[$.length,"/5000"]}),h&&e.jsxs("div",{className:"relative mt-4 rounded-lg overflow-hidden border border-white/10 bg-graphite-light",children:[r!=null&&r.type.startsWith("image/")?e.jsx("img",{src:h,alt:"Preview",className:"w-full max-h-80 object-cover"}):e.jsx("video",{src:h,controls:!0,className:"w-full max-h-80 object-contain bg-graphite-light"}),e.jsx("button",{onClick:xe,className:"absolute top-3 right-3 p-2 bg-graphite-deep/90 backdrop-blur-sm rounded-lg hover:bg-graphite-deep border border-white/10 transition-all",children:e.jsx(se,{className:"w-4 h-4 text-white"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"cursor-pointer group relative",children:[e.jsx("div",{className:"p-2 rounded-lg hover:bg-graphite-light transition-all",children:e.jsx(Ke,{className:"w-4 h-4 text-moon-grey group-hover:text-neon-iris transition-colors"})}),e.jsx("input",{type:"file",accept:"image/*,video/*",onChange:Z,className:"hidden"})]}),e.jsxs("label",{className:"cursor-pointer group relative",children:[e.jsx("div",{className:"p-2 rounded-lg hover:bg-graphite-light transition-all",children:e.jsx(es,{className:"w-4 h-4 text-moon-grey group-hover:text-aqua-pulse transition-colors"})}),e.jsx("input",{type:"file",accept:"video/*",onChange:Z,className:"hidden"})]})]}),e.jsx("button",{onClick:he,disabled:N||!$.trim()&&!r,className:"px-5 py-2 bg-neon-iris text-white rounded-lg font-medium text-sm min-w-[100px] disabled:opacity-40 disabled:cursor-not-allowed hover:bg-neon-iris-light transition-all",children:N?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Posting..."]}):"Post"})]})]}),E?e.jsx("div",{className:"space-y-5",children:Array.from({length:3}).map((a,i)=>e.jsx(ls,{},i))}):l.length===0?e.jsx(J,{icon:We,title:"No posts yet",subtitle:b?"Share your first post":"This user hasn't posted yet"}):e.jsx("div",{className:"space-y-5",children:l.map((a,i)=>e.jsx("div",{style:{animationDelay:`${i*.05}s`},className:"animate-fade-in-up",children:e.jsx(rs,{post:a,onLike:()=>oe(a.id),onToggleReplies:()=>de(a.id),showReplies:Y.has(a.id),onReplyCreated:()=>ce(a.id),profile:t})},a.id))})]}),v==="markets"&&e.jsx(e.Fragment,{children:I?e.jsx("div",{className:"border-t border-white/10",children:Array.from({length:5}).map((a,i)=>e.jsx("div",{className:"px-4 py-3 border-b border-white/5 animate-pulse",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-24 bg-white/10 rounded"}),e.jsx("div",{className:"h-4 w-full bg-white/10 rounded"}),e.jsx("div",{className:"h-3 w-32 bg-white/10 rounded"})]})]})},i))}):C.length===0?e.jsx("div",{className:"border-t border-white/10 py-16",children:e.jsx(J,{icon:B,title:"No markets",subtitle:b?"Create your first prediction market":"This user hasn't created any markets"})}):e.jsx("div",{className:"border-t border-white/10",children:C.map((a,i)=>e.jsx("div",{style:{animationDelay:`${i*.05}s`},className:"animate-fade-in-up",children:e.jsx(os,{market:a})},a.id))})}),v==="trades"&&e.jsx(e.Fragment,{children:f?e.jsx("div",{className:"border-t border-white/10",children:Array.from({length:5}).map((a,i)=>e.jsx("div",{className:"px-4 py-3 border-b border-white/5 animate-pulse",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-24 bg-white/10 rounded"}),e.jsx("div",{className:"h-4 w-full bg-white/10 rounded"}),e.jsx("div",{className:"h-3 w-32 bg-white/10 rounded"})]})]})},i))}):k.length===0?e.jsx("div",{className:"border-t border-white/10 py-16",children:e.jsx(J,{icon:ee,title:"No trades yet",subtitle:b?"Start trading to see your activity here":"This user hasn't made any trades yet"})}):e.jsx("div",{className:"border-t border-white/10",children:k.map((a,i)=>e.jsx("div",{style:{animationDelay:`${i*.05}s`},className:"animate-fade-in-up",children:e.jsx(ds,{trade:a})},a.id))})})]})]})]}):e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center px-4",children:[e.jsx("span",{className:"text-6xl mb-4",children:"ðŸ‘»"}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"User not found"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"This profile doesn't exist or has been removed"}),e.jsx("button",{onClick:()=>d(-1),className:"px-6 py-2.5 rounded-full bg-white/10 text-white font-medium hover:bg-white/20 transition-all",children:"Go back"})]})};export{hs as UserProfile};
