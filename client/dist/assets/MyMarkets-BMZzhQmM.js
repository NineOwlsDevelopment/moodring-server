import{d as A,a7 as F,r as o,az as B,j as e,L as c,h,aA as V,t as x,aB as H}from"./index-Um2jvS2c.js";import{C as T}from"./ConfirmationModal-Dl2TRfgQ.js";const f={all:{label:"All",color:"text-moon-grey",bgColor:"bg-graphite-deep",borderColor:"border-white/10"},pending:{label:"Pending Setup",color:"text-brand-warning",bgColor:"bg-brand-warning/15",borderColor:"border-brand-warning/25"},active:{label:"Active",color:"text-aqua-pulse",bgColor:"bg-aqua-pulse/15",borderColor:"border-aqua-pulse/25"},resolved:{label:"Resolved",color:"text-neon-iris-light",bgColor:"bg-neon-iris/15",borderColor:"border-neon-iris/25"},expired:{label:"Expired",color:"text-brand-danger",bgColor:"bg-brand-danger/15",borderColor:"border-brand-danger/25"}},R=()=>{const{user:m}=A(),w=F(),[i,C]=o.useState("all"),[n,M]=o.useState(null),[L,N]=o.useState(!0),[u,y]=o.useState(null),[g,k]=o.useState(null),[_,p]=o.useState(!1),[b,j]=o.useState(null);o.useEffect(()=>{m&&v()},[m,i]);const v=async()=>{N(!0);try{const s=await B({status:i});M(s)}catch(s){console.error("Failed to load markets:",s)}finally{N(!1)}},S=s=>s.is_initialized?s.is_resolved?"resolved":s.expiration_timestamp<=Math.floor(Date.now()/1e3)?"expired":"active":"pending",$=s=>{const t=new Date(s*1e3),r=new Date,a=t.getTime()-r.getTime();return a<0?`Expired ${Math.abs(Math.floor(a/(1e3*60*60*24)))}d ago`:a<1e3*60*60*24?`${Math.floor(a/(1e3*60*60))}h remaining`:`${Math.floor(a/(1e3*60*60*24))}d remaining`},q=async s=>{var t,r;if(u!==s){y(s);try{const l=(await V(s)).amount;x.success(`Successfully withdrew ${h(l)} in creator fees!`),await v()}catch(a){x.error(((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.error)||"Failed to withdraw fees. Please try again.")}finally{y(null)}}},z=s=>{j(s),p(!0)},D=async()=>{var s,t;if(b){k(b),p(!1);try{await H(b),x.success("Market deleted successfully"),await v()}catch(r){x.error(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.error)||"Failed to delete market. Please try again.")}finally{k(null),j(null)}}},W=()=>{p(!1),j(null)};return m?e.jsx("div",{className:"min-h-screen bg-ink-black",children:e.jsxs("div",{className:"section-container py-8 md:py-12",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-2",children:"My Markets"}),e.jsx("p",{className:"text-moon-grey-dark",children:"Manage and monitor the markets you've created"})]}),e.jsxs(c,{to:"/create",className:"btn btn-secondary",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Market"]})]}),(n==null?void 0:n.statusCounts)&&e.jsx("div",{className:"flex flex-wrap gap-3",children:["all","pending","active","resolved","expired"].map(s=>{const t=f[s],r=s==="all"?n.statusCounts.total:n.statusCounts[s],a=i===s;return e.jsx("button",{onClick:()=>C(s),className:`px-4 py-2.5 rounded-xl transition-all duration-200 border ${a?`${t.bgColor} ${t.borderColor} ${t.color}`:"bg-graphite-deep border-white/10 text-moon-grey hover:border-white/20 hover:bg-graphite-hover"}`,children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("span",{className:"text-sm font-medium",children:t.label}),e.jsx("span",{className:`text-sm font-bold tabular-nums ${a?t.color:"text-white"}`,children:r})]})},s)})})]}),L?e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((s,t)=>e.jsx("div",{className:"card h-40 animate-pulse bg-graphite-deep/50"},t))}):!n||n.markets.length===0?e.jsxs("div",{className:"card text-center py-16",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-graphite-deep border border-white/10 mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-moon-grey-dark",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:i==="all"?"No markets yet":`No ${f[i].label.toLowerCase()} markets`}),e.jsx("p",{className:"text-moon-grey-dark mb-6",children:i==="all"?"Create your first prediction market to get started":"You don't have any markets with this status"}),i==="all"&&e.jsxs(c,{to:"/create",className:"btn btn-secondary",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Your First Market"]})]}):e.jsx("div",{className:"space-y-4",children:n.markets.map(s=>{var l;const t=S(s),r=f[t],a=t==="pending";return e.jsxs("div",{className:"group relative card-hover overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-brand opacity-0 group-hover:opacity-5 transition-opacity duration-300 pointer-events-none"}),e.jsxs("div",{className:"relative flex flex-col lg:flex-row gap-5",children:[e.jsx(c,{to:`/market/${s.id}`,className:"flex-shrink-0 group/image",children:e.jsxs("div",{className:"relative overflow-hidden rounded-xl",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-neon-iris/20 to-aqua-pulse/20 opacity-0 group-hover/image:opacity-60 transition-opacity duration-300 blur-sm"}),e.jsx("img",{src:s.image_url||"/placeholder-market.png",alt:s.question,width:120,height:120,loading:"lazy",className:"relative w-full lg:w-28 h-28 object-cover bg-graphite-deep border-2 border-white/10 group-hover/image:border-neon-iris/30 transition-all duration-300",onError:d=>{d.target.src="https://placehold.co/120x120/1a1a2e/6366f1?text=?"}})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsx("span",{className:`badge ${r.bgColor} ${r.color} ${r.borderColor}`,children:r.label}),(l=s.categories)==null?void 0:l.map(d=>e.jsx("span",{className:"badge badge-neutral",children:d.name},d.id))]}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-3 line-clamp-2 group-hover:text-gradient transition-all",children:s.question}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 text-sm mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-moon-grey",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-moon-grey-dark",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"truncate text-white tabular-nums",children:$(s.expiration_timestamp)})]}),e.jsxs("div",{className:"text-moon-grey",children:[e.jsx("span",{className:"text-moon-grey-dark",children:"Options:"})," ",e.jsx("span",{className:"text-white font-medium tabular-nums",children:s.total_options})]}),s.is_initialized&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-moon-grey",children:[e.jsx("span",{className:"text-moon-grey-dark",children:"Volume:"})," ",e.jsx("span",{className:"text-white font-medium tabular-nums",children:h(s.total_volume)})]}),e.jsxs("div",{className:"text-moon-grey",children:[e.jsx("span",{className:"text-moon-grey-dark",children:"Liquidity:"})," ",e.jsx("span",{className:"text-white font-medium tabular-nums",children:h(s.shared_pool_liquidity)})]}),s.creator_fees_collected>0&&e.jsxs("div",{className:"text-aqua-pulse",children:[e.jsx("span",{className:"text-moon-grey-dark",children:"Fees:"})," ",e.jsx("span",{className:"font-semibold tabular-nums",children:h(s.creator_fees_collected)})]})]})]}),a&&e.jsx("div",{className:"mt-4 p-4 bg-brand-warning/10 border border-brand-warning/25 rounded-xl",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-brand-warning text-sm font-semibold mb-1.5",children:"Setup Required"}),e.jsx("p",{className:"text-moon-grey text-sm leading-relaxed",children:s.total_options===0?"Add options to your market, then add liquidity to start trading.":s.total_options<2?"Add at least 2 options, then add liquidity to start trading.":"Add initial liquidity to activate trading on this market."})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>w(`/create?market=${s.id}`),className:"btn btn-secondary flex-1 sm:flex-none",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Continue Setup"]}),e.jsx("button",{onClick:()=>z(s.id),disabled:g===s.id,className:"btn btn-secondary flex-1 sm:flex-none border-brand-danger/20 text-brand-danger hover:bg-brand-danger/5 hover:border-brand-danger/30 disabled:opacity-50",children:g===s.id?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})})]})]})})]}),e.jsxs("div",{className:"flex flex-row lg:flex-col gap-2 flex-shrink-0 lg:w-32",children:[e.jsxs(c,{to:`/market/${s.id}`,className:"btn btn-secondary flex-1 lg:flex-none",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),e.jsx("span",{className:"hidden sm:inline",children:"View"})]}),t==="expired"&&!s.is_resolved&&e.jsxs("button",{onClick:()=>w(`/market/${s.id}`),className:"btn btn-primary flex-1 lg:flex-none",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"hidden sm:inline",children:"Resolve"})]}),s.creator_fees_collected>0&&e.jsx("button",{onClick:()=>q(s.id),disabled:u===s.id,className:"btn btn-outline border-aqua-pulse/50 text-aqua-pulse hover:bg-aqua-pulse/10 hover:border-aqua-pulse flex-1 lg:flex-none disabled:opacity-50",children:u===s.id?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"hidden sm:inline",children:"Withdrawing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"hidden sm:inline",children:"Withdraw"})]})})]})]})]},s.id)})}),n&&n.pagination.totalPages>1&&e.jsx("div",{className:"flex justify-center gap-2 mt-8",children:Array.from({length:n.pagination.totalPages}).map((s,t)=>{const r=n.pagination.page===t+1;return e.jsx("button",{onClick:()=>{},className:`w-10 h-10 rounded-xl font-semibold text-sm transition-all ${r?"bg-gradient-brand text-white shadow-button-primary hover:shadow-button-primary-hover":"bg-graphite-deep text-moon-grey border border-white/10 hover:border-white/20 hover:bg-graphite-hover hover:text-white"}`,children:t+1},t)})}),e.jsx(T,{isOpen:_,onClose:W,onConfirm:D,title:"Delete Market",message:"Are you sure you want to delete this market? This action cannot be undone. All options and data associated with this market will be permanently removed.",confirmText:"Delete Market",cancelText:"Cancel",variant:"danger",isLoading:g!==null})]})}):e.jsx("div",{className:"min-h-screen bg-ink-black",children:e.jsxs("div",{className:"section-container py-20 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-2xl bg-graphite-deep border border-white/10 mb-6",children:e.jsx("svg",{className:"w-10 h-10 text-neon-iris",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-3",children:"My Markets"}),e.jsx("p",{className:"text-moon-grey",children:"Connect your wallet to view your created markets"})]})})};export{R as MyMarkets};
